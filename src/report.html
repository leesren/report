<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>eher数据报表</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="apple-mobile-web-app-title" content="TMALL">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="format-detection" content="telephone=no, address=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="Description" content="">
    <meta name="Keywords" content="">
    <link rel="stylesheet" type="text/css" href="dist/css/concat.min.css?v=2.0.0">
    <link rel="stylesheet" type="text/css" href="dist/css/style.min.css?v=2.0.0">
    <style>
        [padding] {
            padding: 10px;
        }
        
        [padding-left] {
            padding-left: 10px;
        }
        
        [padding-right] {
            padding-right: 10px;
        }
        
        [padding-left-right] {
            padding-left: 6px;
            padding-right: 6px;
        }
        
        li,
        a,
        span,
        input {
            -webkit-tap-highlight-color: transparent;
            -webkit-tap-highlight-color: transparent;
        }
        
        table,
        th,
        td,
        tbody,
        thead {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }
        
        .main-wraper table tbody td {
            padding: 12px 6px;
        }
        
        tbody tr,
        li,
        a,
        button,
        span,
        div,
        th {
            touch-action: manipulation;
        }
        /*.t-body-tr section:nth-child(odd){background: #fcfcfc;}*/
        
        [flexbox] {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
        }
        
        [align-center] {
            -moz-box-align: center;
            -webkit-box-align: center;
            -o-box-align: center;
            -ms-box-align: center;
            box-align: center;
            -ms-flex-align: center;
            -webkit-align-items: center;
            -o-flex-align: center;
            -moz-align-items: center;
            align-items: center;
        }
        
        .layout-col2-v {
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -webkit-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            min-height: 100%;
            max-height: 100%;
            font-size: 16px;
        }
        
        .layout-clo2-content {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            position: relative;
            overflow: hidden;
            width: 100%;
        }
        
        .scroll-content {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: 1;
            display: block;
            overflow-x: hidden;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
            will-change: scroll-position;
        }
        
        .t-body-tr section {
            /*background-color: #fcfcfc;*/
            border-bottom: 1px solid #eee;
        }
        
        tr[data-id] {
            cursor: pointer;
        }
        
        [text-center] {
            text-align: center !important;
        }
        
        [text-left] {
            text-align: left !important;
        }
        
        [td-more] {
            width: 30px !important;
            min-width: 30px !important;
            max-width: 40px;
        }
        
        .main-wraper .month-text {
            display: -webkit-flexbox;
            display: -webkit-flex;
            display: flex;
            -ms-flex-align: center;
            -webkit-align-items: center;
            align-items: center;
            color: #787878;
            margin-right: 0;
            font-size: 12px;
        }
        
        .main-wraper .month-text.none {
            display: none;
        }
        
        @media screen and (max-width: 768px) {
            .layout-col2-v,
            .main-wraper .p4-table tr,
            .main-wraper .description,
            .main-wraper .description span {
                font-size: 12px;
            }
        }
        
        input.startTime,
        input.endTime {
            width: auto
        }
        
        .searchCheckbox {
            position: relative;
            padding-left: 20px;
            height: 27px;
            font-size: 15px;
            line-height: 27px;
            cursor: pointer;
        }
        
        #searchCheckbox {
            position: absolute;
            top: 6px;
            left: 0;
            width: 16px;
            height: 16px;
            -webkit-appearance: none;
            border: 1px solid #e4cdae;
        }
        
        #searchCheckbox:checked:after {
            position: absolute;
            top: 2px;
            left: 2px;
            content: "";
            width: 10px;
            height: 5px;
            border-left: 1px solid #e4cdae;
            border-bottom: 1px solid #e4cdae;
            transform: rotate(-45deg);
            -webkit-transform: rotate(-45deg);
        }
        
        .none {
            display: none;
        }
        
        .red-block {
            display: inline-block;
            width: 14px;
            height: 14px;
            margin-right: 5px;
            margin-bottom: -3px;
            background-color: red;
        }
        
        .red {
            color: red!important;
        }
        
        .option.on {
            color: #d6ae76;
        }
        
        @media screen and (min-width: 1024px) {
            .main-wraper .table-nav .end-time input,
            .main-wraper .table-nav .start-time input {
                min-width: 110px;
            }
        }
        
        .select {
            display: inline-block;
            max-width: 100%;
            position: relative;
            vertical-align: top
        }
        
        .select.none {
            display: none
        }
        
         ::selection {
            background: #d6ae76;
            /* WebKit/Blink Browsers */
        }
        
        .select option {
            color: #d6ae76;
        }
        
        .select:not(.is-multiple):after {
            border: 1px solid #d6ae76;
            border-right: 0;
            border-top: 0;
            content: " ";
            display: block;
            height: .5em;
            pointer-events: none;
            position: absolute;
            -webkit-transform: rotate(-45deg);
            transform: rotate(-45deg);
            width: .5em;
            margin-top: -.5em;
            right: .825em;
            top: 50%;
            z-index: 4
        }
        
        .select select {
            -moz-appearance: none;
            -webkit-appearance: none;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            border: 1px solid transparent;
            border-radius: 3px;
            box-shadow: none;
            display: -webkit-inline-box;
            display: -ms-inline-flexbox;
            display: inline-flex;
            font-size: 1rem;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            justify-content: flex-start;
            line-height: 1.5;
            padding: calc(.375em - 1px) calc(1.55em - 1px) calc(.375em - 1px) .65em;
            position: relative;
            vertical-align: top;
            background-color: #fff;
            border-color: #dbdbdb;
            color: #363636;
            cursor: pointer;
            display: block;
            font-size: 1em;
            max-width: 100%;
            outline: none
        }
        
        .select select.is-active,
        .select select.is-focused,
        .select select:active,
        .select select:focus {
            outline: none
        }
        
        .select select[disabled]::-webkit-input-placeholder {
            color: hsla(0, 0%, 48%, .3)
        }
        
        .select select:not([multiple]) {
            padding-right: 2.5em
        }
        
        .select select[multiple] {
            height: unset;
        }
        
        .select select[multiple] option {
            padding: .5em 1.5em .5em 1em;
        }
        
        .select.is-grey select {
            border-color: #ddd
        }
        #tb_div{border-left: 0;border-bottom: 0;}
    </style>
</head>

<body>
    <section class="main-wraper">
        <section class="main-content">
            <div class="top-nav">
                <div class="table-nav">
                    <button class="searchByTime myButton" id="exportexcel" style="display:none">导出EXCEL</button>
                    <span class="time-label">
                        <form action class="searchForm" style="display:inline-block;"><div class="search-time"><i class="searchIcon"></i><input type="search" placeholder="请输入关键字" class="searchKey"></div>
                        </form>
                        <div class="sortItem"><div class="dropdown">筛选:<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><em class="currentItem">员工</em></button></div>
                        </div>
                    </span>
                    <span class="time-text">
                        <span class="start-label">起止时间</span>
                    <div class="start-time"><span><input type="date" value="" min="1990-09-09" max="2030-09-18" class="startTime" ></span><em><i class="iconfont">&#xe6a7;</i></em></div>
                    <label>至</label>
                    <div class="end-time">
                        <span><input type="date" value="" min="1990-09-09" max="2030-09-18" class="endTime" ></span><em><i class="iconfont">&#xe6a7;</i></em>
                    </div>
                    </span>
                    <span class="month-text none">
                        <span class="start-label">月份</span>
                    <div class="start-time"><span><input type="month" value="" min="1990-01" max="2030-12"  class="startTime" ></span><em><i class="iconfont">&#xe6a7;</i></em></div>
                    </span>
                    <div style="position: relative;" class="categroy-body none">
                        <input id="categroyInput" placeholder="选择品类" style=" border: 1px solid #ddd;">
                        <div class="none categroy-wrap" style="background: white;position: absolute;
                        left: 0;
                        right: 0;
                        top: 100%;
                        z-index: 10;
                        max-height:274px;
                        overflow:hidden;
                        box-shadow: 0 2px 4px rgba(0,0,0,.12), 0 0 6px rgba(0,0,0,.04);">
                            <ul class="s-li" style="max-height:274px; overflow:scroll;-webkit-overflow-scrolling:touch">  
                            </ul>
                        </div>
                    </div>
                    <div class="select types-select is-grey none">
                        <select name="types" id="types" multiple="multiple" size="5">
                            
                        </select>
                    </div>
                    <div class="select store-select is-grey none">
                        <select id="store" style="margin-left:10px">
                            
                        </select>
                    </div>
                    <label class="searchCheckbox none" for="searchCheckbox">
                        <input type="checkbox" id="searchCheckbox">
                        <span>只显示美容师与顾问</span>
                    </label>
                    <span class="showTip none" style="padding-top: 5px;"></span>
                    <button class="searchByTime myButton">筛选</button>
                </div>
                <div class="description"></div>
            </div>
            <div id="tb_div" class="table-body p4-table-body no-pagination"></div>
            <div class="pagination-box show"><span class="pageInfo"></span>
                <div id="pagination-bar"></div>
            </div>
        </section>
    </section>
    <script type="text/template" id="nodata-tpl">
        <tr>
            <td colspan="<%=len%>" class="nodata-head">暂时没有数据....</td>
        </tr>
    </script>
    <script type="text/template" id="loading-tpl">
        <tr class="loading-tr">
            <td colspan="<%=len%>" class="nodata-head">
                <div class="loader" style="">加载中...</div>
            </td>
        </tr>
    </script>
    <!--start员工报表-->
    <script type="text/template" id="reportEmp-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="moreinfo">
                <tr class="head-nodata">
                    <th class="fixed-coloum-header">姓名</th>
                    <th class="">员工类型</th>
                    <th class="sortable" data-sort="personNum">人次</th>
                    <th class="sortable" data-sort="pNumber">人头数</th>
                    <th class="sortable" data-sort="sellNumber">销售项目数</th>
                    <th class="sortable" data-sort="consumeNumber">项目消耗数</th>
                    <th class="sortable" data-sort="giftConsumeNumber">赠送项目消耗数</th>
                    <th class="sortable" data-sort="salesAch">销售业绩</th>
                    <th>销售业绩占比</th>
                    <th class="sortable" data-sort="saleCom">销售提成</th>
                    <th class="sortable" data-sort="consumeAch">消耗业绩</th>
                    <th>消耗业绩占比</th>
                    <th class="sortable" data-sort="consumeCom">消耗提成</th>
                    <th class="sortable" data-sort="manualCom">手工工资</th>
                    <th class="sortable" data-sort="appointManualCom">指定业绩</th>
                    <th class="sortable" data-sort="noAppointManualCom">非指定业绩</th>
                    <th class="sortable" data-sort="sumCom">提成合计</th>
                    <th class="">所属门店</th>
                    <th style="text-align:center;width:60px !important;min-width:60px !important;max-width:240px;">备注</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody moreinfo">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.eid%>" data-name="<%=el.name%>">
                        <td class="text first-coloum-flag">
                            <%=el.name%>
                        </td>
                        <td class="text">
                            <%=el.postType%>
                        </td>
                        <td class="num">
                            <%=el.personNum%>
                        </td>
                        <td class="num">
                            <%=miliFormat(el.pNumber)%>
                        </td>
                        <td class="num">
                            <%=miliFormat(el.sellNumber)%>
                        </td>
                        <td class="num">
                            <%=miliFormat(el.consumeNumber)%>
                        </td>
                        <td class="num">
                            <%=miliFormat(el.giftConsumeNumber)%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.salesAch-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((((el.salePercent-0)*100).toFixed(2)-0))%>%</td>
                        <td class="num">
                            <%=miliFormat(((el.saleCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumeAch-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((((el.consumePercent-0)*100).toFixed(2)-0))%>%</td>
                        <td class="num">
                            <%=miliFormat(((el.consumeCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.manualCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.appointManualCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.noAppointManualCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sumCom-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td style="text-align:center;width:60px !important;min-width:60px !important;max-width:240px;">-</td>
                        <%if(device().isMobile){%>
                            <td style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"><i class="iconfont">&#xe6a7;</i></td>
                            <%}else{%>
                                <td class="text"><a class="emp-detailBtn" data-role="sale" data-id="<%=el.eid%>" style="color: #d6ae76;display: inline-block;border: 1px solid #e4cdae;border-radius: 4px;padding: 2px 4px;">销售详情<i class="iconfont">&#xe629;</i></a>
                                    <a class="emp-detailBtn" data-role="consume" data-id="<%=el.eid%>" style="color: #d6ae76;display: inline-block;border: 1px solid #e4cdae;border-radius: 4px;padding: 2px 4px;margin-left: 6px;">消耗详情<i class="iconfont">&#xe629;</i></a>
                                </td>
                                <%}%>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end员工报表-->
    <!--start员工销售详情-->
    <script type="text/template" id="reportEmpSaleDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="head-nodata">
                    <th class="fixed-coloum-header">姓名</th>
                    <th>员工类型</th>
                    <th>受理单号</th>
                    <th>日期</th>
                    <th>客户</th>
                    <th>客户类型</th>
                    <th>受理单类型</th>
                    <th>品类</th>
                    <th>项目</th>
                    <th>类型</th>
                    <th>数量</th>
                    <th>单价</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="commission">销售提成</th>
                    <th class="text">备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){var itemList=el.itemList;var rowspan=(itemList.length===0?'':itemList.length);var firstItem=itemList.slice(0,1);%>
                    <tr>
                        <td rowspan="<%=rowspan%>" class="text first-coloum-flag">
                            <%=el.name%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.postType%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.code%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.date%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.customerName%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.customerType%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.orderType%>
                        </td>
                        <td class="text">
                            <%=firstItem[0]?firstItem[0].productCategory:''%>
                        </td>
                        <td class="text">
                            <%=firstItem[0]?firstItem[0].itemName:''%>
                        </td>
                        <td class="text">
                            <%=firstItem[0]?firstItem[0].productTypeName:''%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((firstItem[0]?firstItem[0].orderNum-0:0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((firstItem[0]?firstItem[0].price-0:0).toFixed(2)-0))%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="num">
                            <%=miliFormat(((el.commission-0).toFixed(2)-0))%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">-</td>
                    </tr>
                    <%if(itemList.length>0){itemList.slice(1,rowspan).map(function(item,i){%>
                        <tr>
                            <td class="text">
                                <%=item.productCategory%>
                            </td>
                            <td class="text">
                                <%=item.itemName%>
                            </td>
                            <td class="text">
                                <%=item.productTypeName%>
                            </td>
                            <td class="num">
                                <%=!item.orderNum?0:miliFormat(((item.orderNum-0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((item.price-0).toFixed(2)-0))%>
                            </td>
                        </tr>
                        <%})}%>
                            <%});%>
            </tbody>
        </table>
    </script>
    <!--end员工销售详情-->
    <!--start欠款详情-->
    <script type="text/template" id="reportArrearDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="head-nodata">
                    <th class="fixed-coloum-header">客户</th>
                    <th>开单日期</th>
                    <th>所属顾问</th>
                    <th>应收</th>
                    <th>实收</th>
                    <th>欠款</th>
                    <th>项目</th>
                    <th>项目类型</th>
                    <th>总次数/金额</th>
                    <th>消耗次数/金额</th>
                    <th>剩余次数/金额</th>
                    <th>单号</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){var itemList=el.items;var rowspan=(itemList.length===0?'':itemList.length);var firstItem=itemList.slice(0,1);var disabled=el.isCloseCus=='1'?'red':''%>
                    <tr class="<%=disabled%>">
                        <td rowspan="<%=rowspan%>" class="text first-coloum-flag">
                            <%=el.customerName%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.date%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.empName%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=miliFormat((el.allMoney-0).toFixed(2)-0)%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=miliFormat((el.recivedMoney-0).toFixed(2)-0)%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=miliFormat((el.restMoney-0).toFixed(2)-0)%>
                        </td>
                        <td class="text">
                            <%=firstItem[0]?firstItem[0].tpName:''%>
                        </td>
                        <td class="text">
                            <%=firstItem[0]?firstItem[0].type:''%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((firstItem[0]?firstItem[0].total-0:0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((firstItem[0]?firstItem[0].used-0:0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((firstItem[0]?firstItem[0].rest-0:0).toFixed(2)-0))%>
                        </td>
                        <td rowspan="<%=rowspan%>" class="text">
                            <%=el.orderCode%>
                        </td>
                    </tr>
                    <%if(itemList.length>0){itemList.slice(1,rowspan).map(function(item,i){%>
                        <tr class="<%=disabled%>">
                            <td class="text">
                                <%=item.tpName%>
                            </td>
                            <td class="text">
                                <%=item.type%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((item.total?item.total-0:0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((item.used?item.used-0:0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((item.rest?item.rest-0:0).toFixed(2)-0))%>
                            </td>
                        </tr>
                        <%})}%>
                            <%});%>
            </tbody>
        </table>
    </script>
    <!--end欠款详情-->

    <!--start员工消耗详情-->
    <script type="text/template" id="reportEmpComDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="head-nodata">
                    <th class="fixed-coloum-header">姓名</th>
                    <th>员工类型</th>
                    <th>工单号</th>
                    <th>日期</th>
                    <th>客户</th>
                    <th>客户类型</th>
                    <th>品类</th>
                    <th>项目</th>
                    <th>房间</th>
                    <th class="sortable" data-sort="consumeNumber">消耗数</th>
                    <th>支付方式</th>
                    <th class="sortable" data-sort="consume">消耗业绩</th>
                    <th class="sortable" data-sort="commission">消耗提成</th>
                    <th class="sortable" data-sort="extrawage">手工工资</th>
                    <th>是否指定</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){var experienceCard=(el.isAppoint)==1?'experienceCard':'';%>
                    <tr class="<%=experienceCard%>">
                        <td class="text first-coloum-flag">
                            <%=el.eName%>
                        </td>
                        <td class="text">
                            <%=el.postType%>
                        </td>
                        <td class="text">
                            <%=el.code%>
                        </td>
                        <td class="text">
                            <%=el.date%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.customerType%>
                        </td>
                        <td class="text">
                            <%=el.productCategory%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="text">
                            <%=el.roomName%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumeNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">
                            <%=el.payment%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.commission-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.extrawage-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">
                            <%=el.isAppoint==1 ? '是' : '否'%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end员工消耗详情-->
    <!--start客户报表-->
    <script type="text/template" id="reportCustomer-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="head-nodata">
                    <th class="fixed-coloum-header">姓名</th>
                    <th>编号</th>
                    <th>会员类型</th>
                    <th class="sortable" data-sort="rechargeNum">充值次数</th>
                    <th class="sortable" data-sort="rechargeMoney">充值金额业绩</th>
                    <th class="sortable" data-sort="balanceUse">充值金额消耗业绩</th>
                    <th class="sortable" data-sort="cosmeticsNumber">销售商品数</th>
                    <th>销售项目数</th>
                    <th>消耗项目数</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consume">消耗业绩</th>
                    <th class="">来源类型</th>
                    <th class="">预约情况(签到/预约)</th>
                    <th class="sortable" data-sort="arriveCount">到店天数</th>
                    <th class="sortable" data-sort="frequency">频次</th>
                    <th>所属门店</th>
                    <th>所属顾问</th>
                    <th>注册日期</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text first-coloum-flag">
                            <%=el.csutomerName%>
                        </td>
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerType%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.rechargeNum-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.rechargeMoney-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.balanceUse-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cosmeticsNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.sellNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.doNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=el.sourceName%>
                        </td>
                        <td class="num">
                            <%=el.signCount+' / '+el.appCount%>
                        </td>
                        <td class="num">
                            <%=el.arriveCount%>
                        </td>
                        <td class="num">
                            <%=el.frequency%>
                        </td>
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td class="text">
                            <%=el.advisor%>
                        </td>
                        <td class="text">
                            <%=el.registerDate%>
                        </td>
                        <td class="text">
                            <%='最近到访'+el.latest%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户报表-->
    <!--start客户负债报表-->
    <script type="text/template" id="reportTotalDebt-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="multi-header">
                <tr>
                    <th rowspan="2" class="fixed-coloum-header">姓名</th>
                    <th rowspan="2">编号</th>
                    <th colspan="5" class="multi-cols">未消耗金额</th>
                    <th rowspan="2" class="sortable" data-sort="debtMoney">欠款金额</th>
                    <th rowspan="2" class="sortable" data-sort="debtCount">欠款单数量</th>
                    <th rowspan="2">最近还款日期</th>
                    <th rowspan="2">所属门店</th>
                    <th rowspan="2">备注</th>
                </tr>
                <tr>
                    <th class="sortable" data-sort="memberBalance">会员卡</th>
                    <th class="sortable" data-sort="cardBalance">金额卡</th>
                    <th class="sortable" data-sort="restCardAmount">项目卡</th>
                    <th class="sortable" data-sort="giftAmount">赠送合计</th>
                    <th class="sortable" data-sort="sumAmount">合计</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text first-coloum-flag">
                            <%=el.name%>
                        </td>
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.memberBalance-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cardBalance-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.giftAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sumAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.debtMoney-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.debtCount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=el.latest%>
                        </td>
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户负债报表-->
    <!--start产品汇总-->
    <script type="text/template" id="reportProduct-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th>类型</th>
                    <th class="sortable" data-sort="price">销售单价</th>
                    <th class="sortable" data-sort="sellNumber">销售数量</th>
                    <th class="sortable" data-sort="consumeNumber">消耗次数</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consumes">消耗业绩</th>
                    <th>备注</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-name="<%=el.name%>" data-id="<%=el.id%>">
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="text">
                            <%=el.productType%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.price-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sellNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumeNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumes-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i> </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end产品汇总-->
    <!--start产品汇总详情-->
    <script type="text/template" id="reportProductDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>客户姓名</th>
                    <th>购买金额</th>
                    <th>购买数量</th>
                    <th>消耗数量</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sellNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumeNumber-0).toFixed(2)-0))%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end产品汇总详情-->
    <!--start卡项负债-->
    <script type="text/template" id="reportCard-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>项目卡名称</th>
                    <th class="sortable" data-sort="totalNumber">数量</th>
                    <th class="sortable" data-sort="totalTimes">总次数</th>
                    <th class="sortable" data-sort="totalUsedTimes">剩余次数</th>
                    <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                    <th>备注</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-name="<%=el.name%>" style="cursor: pointer;">
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalRestTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                        <td style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"><i class="iconfont">&#xe6a7;</i></td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end卡项负债-->
    <!--start卡项负债明细-->
    <script type="text/template" id="reportCardDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>会员编号</th>
                    <th>会员姓名</th>
                    <th>项目卡名称</th>
                    <th class="sortable" data-sort="totalTimes">总次数</th>
                    <th class="sortable" data-sort="totalUsedTimes">剩余次数</th>
                    <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="num">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.cardName%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalRestTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end卡项负债明细-->

    <!--start区域汇总退款报表-->
    <script type="text/template" id="reportAreaRefund-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>组织名称</th>
                    <th class="sortable" data-sort="cashPaySum">退款金额（现金）汇总</th>
                    <th class="sortable" data-sort="balancePaySum">退款金额（会员卡）汇总</th>
                    <th class="sortable" data-sort="productPaySum">退款金额（金额卡）汇总</th>
                    <th>备注</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-storeId="<%=el.storeId%>" data-storeName="<%=el.storeName%>" style="cursor: pointer;">
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.cashPaySum-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.balancePaySum-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.productPaySum-0)-0))%>
                        </td>
                        <td class="text">-</td>
                        <td style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"><i class="iconfont">&#xe6a7;</i></td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end区域汇总退款报表-->
    <!--start退款报表-->
    <script type="text/template" id="reportRefund-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>会员编号</th>
                    <th>会员姓名</th>
                    <th>退款产品</th>
                    <th>退卡次数/金额</th>
                    <th class="sortable" data-sort="refundMoney">退款金额</th>
                    <th>退款日期</th>
                    <th>退款方式</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-storeId="<%=el.storeId%>">
                        <td class="num">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="num">
                            <%=el.typeCode=="amountCard" ? miliFormat((el.refundBalance-0)) : el.refundTimes%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.refundMoney-0))%>
                        </td>
                        <td class="num">
                            <%=el.date%>
                        </td>
                        <td class="text">
                            <%=el.refundType%>
                        </td>
                        <td class="text">
                            <%=el.note ? el.note : '-'%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end退款报表-->

    <!--start消耗单明细-->
    <script type="text/template" id="reportWorkDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <% var path = new Path();var map = path.paraMap(window.location.href);%>
                <thead class="multi-header">
                    <tr>
                        <th rowspan="2" class="fixed-coloum-header">客户</th>
                        <th rowspan="2">客户编号</th>
                        <!--<% 
                        if(map.organizationId) {
                        %>
                           <th rowspan="2">门店</th>
                        <%   
                        }
                    %>-->
                        <th rowspan="2">日期</th>
                        <th rowspan="2">客户类型</th>
                        <th rowspan="2">订单类型</th>
                        <th rowspan="2">服务项目</th>
                        <th rowspan="2">项目分类</th>

                        <th rowspan="2">服务次数</th>
                        <th rowspan="2">服务房间</th>
                        <th rowspan="2">支付卡项</th>
                        <th rowspan="2">门店消耗业绩</th>
                        <th rowspan="2">赠送消耗</th>
                        <th colspan="6" text-center>参与员工消耗业绩详情</th>
                        <th rowspan="2">星级评分</th>
                        <th rowspan="2">专属顾问</th>
                        <th rowspan="2">专属技师</th>
                        <th rowspan="2">邀约人</th>
                        <th rowspan="2">开单者</th>
                        <th rowspan="2">门店</th>
                        <th rowspan="2">受理单号</th>
                        <th rowspan="2">补单情况</th>
                        <th rowspan="2">备注</th>
                    </tr>
                    <tr>
                        <th>人员</th>
                        <th>是否指定</th>
                        <th>职位</th>
                        <th>消耗业绩</th>
                        <th>消耗提成</th>
                        <th>手工工资</th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%var orderType=['正常','预付款','体验券'];data.map(function(el,index){var rowspan=(el.workEmpList.length===0?'':el.workEmpList.length);var emp=(el.workEmpList.length===0?[]:el.workEmpList[0]);var isUx=((el.orderType-0)===2);var orderTypeText=((el.orderType-0)===2||(el.orderType-0)===1?'<span class="pointRed">'+orderType[el.orderType-0]+''+(el.sourceName?'<i style="font-size: 14px;font-style: oblique;">(派发人: '+el.sourceName+')</i></span>':''):orderType[el.orderType-0]);var experienceCard=(el.orderType-0)===2||(el.orderType-0)===1||el.inviters?'experienceCard':'';%>
                        <tr class="<%=experienceCard%>">
                            <td rowspan="<%=rowspan%>" class="text first-coloum-flag">
                                <%=el.customerName%>
                            </td>
                            <td rowspan="<%=rowspan%>">
                                <%=el.customerNo%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text"><span style="vertical-align:middle"><%=el.date%></span></td>

                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.customerType%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=orderTypeText%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.serverProduct%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.category%>
                            </td>

                            <td rowspan="<%=rowspan%>" class="num">
                                <%=el.serverNumber%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.roomName%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.useCard%>
                            </td>

                            <td rowspan="<%=rowspan%>" class="num" data-key="sumConsume">
                                <%=miliFormat(((el.storeConsume-0).toFixed(2)-0))%>
                            </td>

                            <td rowspan="<%=rowspan%>" class="num" data-key="sumGiftConsume">
                                <%=miliFormat(((el.giftConsume-0).toFixed(2)-0))%>
                            </td>
                            <td class="text"><span style="vertical-align: middle;"><%=emp.empName%></span>
                                <!-- <%
                                     if(emp.isAppont == 1 ){
                                       %>
                                    <span style="color:#11cd6e">[指定]</span>
                                    <%
                                     }
                                %> -->
                            </td>
                            <td class="text">
                                <% if(emp.isAppont == 1 ){ %><span style="color:#11cd6e">是</span>
                                    <%}else { %>
                                        <span>否</span>
                                        <%}%>
                            </td>
                            <td class="text">
                                <%=emp.postType%>
                            </td>
                            <td class="num" data-key="sumCA">
                                <%=(emp.consumeAch=="*"?emp.consumeAch:miliFormat(((emp.consumeAch-0).toFixed(2)-0)))%>
                            </td>
                            <td class="num" data-key="sumCC">
                                <%=(emp.commission=="*"?emp.commission:miliFormat(((emp.commission-0).toFixed(2)-0)))%>
                            </td>
                            <td class="num" data-key="sumEx">
                                <%=(emp.extrawage=="*"?emp.extrawage:miliFormat(((emp.extrawage-0).toFixed(2)-0)))%>
                            </td>
                            <td class="text" rowspan="<%=rowspan%>">
                                <div style="font-size:12px;">
                                    <%=el.evaluteDes?el.evaluteDes:'-'%>
                                </div>
                                <%
                                if(!excle){
                                %>
                                    <div style="line-height: 1;height: 14px;">
                                        <%for(var k=0;k<el.evaluateValue;k++){%><img style="display:inline-block;height:14px;width:14px;color:red" src="dist/images/star.svg">
                                            <%}%>
                                    </div>
                                    <%
                                }
                                %>

                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.advisor%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.beautician%>
                            </td>
                            <td class="text" rowspan="<%=rowspan%>">
                                <%=el.inviters?el.inviters:'-'%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.openEmp?el.openEmp:'-'%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.storeName%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.code%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%
                                     if(el.isFix == '0' ){
                                       %><span>正常</span>
                                    <%
                                     }else if(el.isFix == '1'){
                                        %><span>补单</span>
                                        <%
                                     }else if(el.isFix == '2'){
                                        %><span>线下卡补单</span>
                                            <%
                                     }
                                %>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">-</td>
                        </tr>
                        <%if(el.workEmpList.length>0){el.workEmpList.splice(0,1);el.workEmpList.map(function(emp,index){
                          var isAppoint = emp.isAppont == 1 ? 'dist/images/appointment.svg' : '' ; //isAppoint 1是指定，0是非指定
                    %>
                            <tr class="<%=experienceCard%>">
                                <td class="text"><span style="vertical-align: middle;"><%=emp.empName%></span>
                                    <!-- <% if(emp.isAppont == 1 ){ %><span style="color:#11cd6e">[指定]</span>
                                        <%}%> -->
                                </td>
                                <td class="text">
                                    <% if(emp.isAppont == 1 ){ %>
                                        <span style="color:#11cd6e">是</span>
                                        <%}else { %>
                                            <span>否</span>
                                            <%}%>
                                </td>
                                <td class="text">
                                    <%=emp.postType%>
                                </td>
                                <td class="num"  data-key="sumCA">
                                    <%=(emp.consumeAch=="*"?emp.consumeAch:miliFormat(((emp.consumeAch-0).toFixed(2)-0)))%>
                                </td>
                                <td class="num" data-key="sumCC">
                                    <%=(emp.commission=="*"?emp.commission:miliFormat(((emp.commission-0).toFixed(2)-0)))%>
                                </td>
                                <td class="num" data-key="sumEx">
                                    <%=(emp.extrawage=="*"?emp.extrawage:miliFormat(((emp.extrawage-0).toFixed(2)-0)))%>
                                </td>
                            </tr>
                            <%});}});%>
                </tbody>
        </table>
    </script>
    <!--end消耗单明细-->
    <!--start销售明细-->
    <script type="text/template" id="reportMarketDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <% var path = new Path();
               var map = path.paraMap(window.location.href);
               var headerList = eval('(' + window.localStorage.getItem("businessHeader") + ')');
            %>
                <thead class="multi-header">
                    <tr>
                        <th rowspan="2" class="fixed-coloum-header">客户</th>
                        <!--<% 
                        if(map.organizationId) {
                        %>
                           <th rowspan="2">门店</th>
                        <%   
                        }
                    %>-->
                        <th rowspan="2">客户编号</th>
                        <th rowspan="2">日期</th>
                        <th rowspan="2">客户类型</th>
                        <th rowspan="2">项目</th>
                        <th rowspan="2">项目分类</th>

                        <th rowspan="2">数量</th>
                        <th rowspan="2">单价</th>
                        <th rowspan="2">实收金额</th>
                        <th colspan="<%=headerList.length%>" style="text-align:center">支付详情</th>
                        <th rowspan="2">赠送</th>
                        <th rowspan="2">门店销售业绩</th>
                        <th colspan="4" style="text-align:center">参与员工及销售业绩详情</th>
                        <th rowspan="2">邀约人</th>
                        <th rowspan="2">开单者</th>
                        <th rowspan="2">门店</th>
                        <th rowspan="2">受理单号</th>
                        <th rowspan="2">补单情况</th>
                        <th rowspan="2">备注</th>
                    </tr>
                    <tr>
                        <!--<th>现金</th>
                    <th>储蓄卡</th>
                    <th>信用卡</th>
                    <th>会员卡</th>
                    <th>金额卡</th>
                    <th>赠送</th>

                    <th>百度钱包</th>
                    <th>QQ钱包</th>

                    <th>支付宝</th>
                    <th>微信支付</th>
                    <th>京东支付</th>
                    <th>招联支付</th>
                    <th>其他支付</th>-->
                            <% headerList.map(function(el,index){%>
                                <th>
                                    <%=el.name%>
                                </th>
                            <%});%> 
                            <th>人员</th>
                            <th>职位</th>
                            <th>销售业绩</th>
                            <th>销售提成</th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){
                    var len1=el.itemList.length;
                    var len2=el.marketEmpList.length;
                    var items=el.itemList[0];
                    var emp=el.marketEmpList[0];
                    var rowspan=(el.itemList.length>el.marketEmpList.length?el.itemList.length:el.marketEmpList.length);
                    var decomposition=window.decomposition(len1,len2);
                    var divisor=decomposition.list;
                var indexing=decomposition.map;
                var combine1=1;var combine2=1;
                var experienceCard=el.inviters?'experienceCard':'';
                if(len1>=len2){
                    combine2=divisor[0];// 4=> 2 1 1
                    }
                else{
                    combine1=divisor[0];
                }%>
                        <tr class="<%=experienceCard%>">
                            <td rowspan="<%=rowspan%>" class="text first-coloum-flag">
                                <%=el.customerName%>
                            </td> 
                            <td rowspan="<%= rowspan %>"><%=el.customerNo %></td>
                            <td rowspan="<%= rowspan %>">
                                <%=el.date %>
                            </td>
                            <td rowspan="<%= rowspan %>" class="text">
                                <%=el.customerType%>
                            </td>
                            <td class="text" rowspan="<%=combine1%>">
                                <%=(items?items.itemName:'')%>
                            </td>
                            <td class="text" rowspan="<%=combine1%>">
                                <%=(items?items.category:'')%>
                            </td>

                            <td class="num" rowspan="<%=combine1%>">
                                <%=(items?miliFormat((items.orderNum-0)):'')%>
                            </td>
                            <td class="num" rowspan="<%=combine1%>">
                                <%=(items?miliFormat(((items.price-0).toFixed(2)-0)):'')%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num" data-key="sumRec">
                                <%=miliFormat(((el.realRec-0).toFixed(2)-0))%>
                            </td> 
                            <%el.pmList.map(function(e,index){
                                // 处理现金、实收和银联的总额对应关系 cashPay -> sumCash , unionPay -> sumUnion，realRec -> sumRec
                                var tcode = e.code;
                                if(e.code == 'cashPay'){tcode = 'sumCash'}
                                if(e.code == 'unionPay'){tcode = 'sumUnion'}
                                %>
                                <td rowspan="<%=rowspan%>" class="num" data-key="<%=tcode%>">
                                    <%=miliFormat(((e.amount-0).toFixed(2)-0))%>
                                </td>
                                <%});%>
                                    <td rowspan="<%=rowspan%>" class="num">
                                        <%=miliFormat(((el.gift-0).toFixed(2)-0))%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="num">
                                        <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                                    </td>
                                    <td class="text" rowspan="<%=combine2%>">
                                        <%=(emp?emp.empName:'')%>
                                    </td>
                                    <td class="text" rowspan="<%=combine2%>">
                                        <%=(emp?emp.postType:'')%>
                                    </td>
                                    <td class="num" rowspan="<%=combine2%>" data-key="sumSales">
                                        <%=(emp&&emp.empSales!='*'?miliFormat(emp.empSales-0):emp.empSales)%>
                                    </td>
                                    <td class="num" rowspan="<%=combine2%>" data-key="scSum">
                                        <%=(emp&&emp.empSaleCommission!='*'?miliFormat(emp.empSaleCommission-0):emp.empSaleCommission)%>
                                    </td>
                                    <td class="text experienceCard" rowspan="<%=rowspan%>">
                                        <%=el.inviters?el.inviters:'-'%>
                                    </td>
                                    <td class="text" rowspan="<%=rowspan%>">
                                        <%=el.openEmp%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%=el.storeName%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%=el.code%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%
                                     if(el.isFix == '0' ){
                                       %><span>正常</span>
                                            <%
                                     }else if(el.isFix == '1'){
                                        %><span>补单</span>
                                                <%
                                     }else if(el.isFix == '2'){
                                        %><span>线下卡补单</span>
                                        <%
                                        }
                                        %>
                                    </td>
                                    <td class="text" rowspan="<%=rowspan%>">-</td>
                        </tr>
                        <%var count=1;
                        if(len1>=len2){
                            el.itemList.map(function(item,index){
                            if(index===0)return;
                            var emps=el.marketEmpList[count];
                             var empSales;if(emps){
                                empSales=(emps.empSales!='*'?miliFormat(((emps.empSales-0).toFixed(2)-0)):emps.empSales);
                                empSaleCommission=(emps.empSaleCommission!='*'?miliFormat(((emps.empSaleCommission-0).toFixed(2)-0)):emps.empSaleCommission);}%>
                            <tr class="<%=experienceCard%>">
                                <td class="text">
                                    <%=(item.itemName)%>
                                </td>
                                <td class="text">
                                    <%=(item.category)%>
                                </td>
                                <td class="num">
                                    <%=(item.orderNum)%>
                                </td>
                                <td class="num">
                                    <%=miliFormat(((item.price-0).toFixed(2)-0))%>
                                </td>
                                <%
                                    if( emps && (indexing[count].index===index)){
                                    var v=indexing[count].value;
                                %>
                                    <td class="text" rowspan="<%=v%>">
                                        <%=(emps.empName)%>
                                    </td>
                                    <td class="text" rowspan="<%=v%>">
                                        <%=(emps.postType)%>
                                    </td>
                                    <td class="num" rowspan="<%=v%>">
                                        <%=empSales%>
                                    </td>
                                    <td class="num" rowspan="<%=v%>">
                                        <%=empSaleCommission%>
                                    </td>
                                    <%count++;}%>
                            </tr>
                            <%});}else{
                                count=1;   
                                el.marketEmpList.map(function(emps,index){
                                if(index === 0)return;
                                var item = el.itemList[count];
                            %>
                                <tr class="<%=experienceCard%>">
                                    <%
                                        if( item && (indexing[count].index===index)){
                                            var v=indexing[count].value;
                                    %>
                                        <td class="text" rowspan="<%=v%>">
                                            <%=(item.itemName)%>
                                        </td>
                                        <td class="text" rowspan="<%=v%>">
                                            <%=(item.category)%>
                                        </td>
                                        <td class="num" rowspan="<%=v%>">
                                            <%=(item.orderNum)%>
                                        </td>
                                        <td class="num" rowspan="<%=v%>">
                                            <%=(item?((item.price-0).toFixed(2)-0).toLocaleString():'')%>
                                        </td>
                                        <%
                                            count++;
                                        }%>
                                            <td class="text">
                                                <%=(emps.empName)%>
                                            </td>
                                            <td class="text">
                                                <%=(emps.postType)%>
                                            </td>
                                            <td class="num" data-key="sumSales">
                                                <%=(emps.empSales!="*"?miliFormat(((emps.empSales-0).toFixed(2)-0)):emps.empSales)%>
                                            </td>
                                            <td class="num" data-key="scSum">
                                                <%=(emps.empSaleCommission!="*"?miliFormat(((emps.empSaleCommission-0).toFixed(2)-0)):emps.empSaleCommission)%>
                                            </td>
                                </tr>
                                <%});}});%>
                </tbody>
        </table>
    </script>

    <!--end销售明细-->
    <!--start订单明细-->
    <script type="text/template" id="reportMarketDetailConsume-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <% var path = new Path();var map = path.paraMap(window.location.href);var headerList= eval('(' + window.localStorage.getItem("businessHeader") + ')');%>
                <thead class="multi-header">
                    <tr>
                        <th rowspan="2" class="fixed-coloum-header">客户</th>
                        <th rowspan="2">日期</th>
                        <th rowspan="2">客户类型</th>
                        <th rowspan="2">项目</th>
                        <th rowspan="2">数量</th>
                        <th rowspan="2">单价</th>
                        <th rowspan="2">实收金额</th>
                        <th colspan="<%=headerList.length%>" style="text-align:center">支付详情</th>
                        <th rowspan="2">门店消耗业绩</th>
                        <th colspan="4" style="text-align:center">参与员工及消耗业绩详情</th>
                        <th rowspan="2">邀约人</th>
                        <th rowspan="2">开单者</th>
                        <th rowspan="2">门店</th>
                        <th rowspan="2">受理单号</th>
                        <th rowspan="2">补单情况</th>
                        <th rowspan="2">备注</th>
                    </tr>
                    <tr>
                        <!--<th>现金</th>
                        <th>银联</th>
                        <th>会员卡</th>
                        <th>金额卡</th>
                        <th>赠送</th>-->
                        <% headerList.map(function(el,index){%>
                            <th>
                                <%=el.name%>
                            </th>
                            <%});%>
                                <th>人员</th>
                                <th>职位</th>
                                <th>消耗业绩</th>
                                <th>消耗提成</th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){var len1=el.itemList.length;var len2=el.marketEmpList.length;var items=el.itemList[0];var emp=el.marketEmpList[0];var rowspan=(el.itemList.length>el.marketEmpList.length?el.itemList.length:el.marketEmpList.length);var decomposition=window.decomposition(len1,len2);var divisor=decomposition.list;var indexing=decomposition.map;var combine1=1;var combine2=1;var experienceCard=el.inviters?'experienceCard':'';if(len1>=len2){combine2=divisor[0];}else{combine1=divisor[0];}%>
                        <tr class="<%=experienceCard%>">
                            <td rowspan="<%=rowspan%>" class="text first-coloum-flag">
                                <%=el.customerName%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.date%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="text">
                                <%=el.customerType%>
                            </td>
                            <td class="text" rowspan="<%=combine1%>">
                                <%=(items?items.itemName:'')%>
                            </td>
                            <td class="num" rowspan="<%=combine1%>">
                                <%=(items?miliFormat((items.orderNum-0)):'')%>
                            </td>
                            <td class="num" rowspan="<%=combine1%>">
                                <%=(items?miliFormat(((items.price-0).toFixed(2)-0)):'')%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.realRec-0).toFixed(2)-0))%>
                            </td>
                            <!--<td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.cashPay-0).toFixed(2)-0))%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.unionPay-0).toFixed(2)-0))%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.balancePay-0).toFixed(2)-0))%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.productPay-0).toFixed(2)-0))%>
                            </td>
                            <td rowspan="<%=rowspan%>" class="num">
                                <%=miliFormat(((el.gift-0).toFixed(2)-0))%>
                            </td>-->
                            <%el.pmList.map(function(e,index){%>
                                <td rowspan="<%=rowspan%>" class="num">
                                    <%=miliFormat(((e.amount-0).toFixed(2)-0))%>
                                </td>
                                <%});%>
                                    <td rowspan="<%=rowspan%>" class="num">
                                        <%=miliFormat(((el.consume-0).toFixed(2)-0))%>
                                    </td>
                                    <td class="text" rowspan="<%=combine2%>">
                                        <%=(emp?emp.empName:'')%>
                                    </td>
                                    <td class="text" rowspan="<%=combine2%>">
                                        <%=(emp?emp.postType:'')%>
                                    </td>
                                    <td class="num" rowspan="<%=combine2%>">
                                        <%=(emp&&emp.empConsume!='*'?miliFormat(emp.empConsume-0):emp.empConsume)%>
                                    </td>
                                    <td class="num" rowspan="<%=combine2%>">
                                        <%=(emp&&emp.empConsumeComission!='*'?miliFormat(emp.empConsumeComission-0):emp.empConsumeComission)%>
                                    </td>
                                    <td class="text experienceCard" rowspan="<%=rowspan%>">
                                        <%=el.inviters?el.inviters:'-'%>
                                    </td>
                                    <td class="text" rowspan="<%=rowspan%>">
                                        <%=el.openEmp?el.openEmp:'-'%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%=el.storeName%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%=el.code%>
                                    </td>
                                    <td rowspan="<%=rowspan%>" class="text">
                                        <%
                                     if(el.isFix == '0' ){
                                       %><span>正常</span>
                                            <%
                                     }else if(el.isFix == '1'){
                                        %><span>补单</span>
                                                <%
                                     }else if(el.isFix == '2'){
                                        %><span>线下卡补单</span>
                                                    <%
                                     }
                                %>
                                    </td>
                                    <td class="text" rowspan="<%=rowspan%>">-</td>
                        </tr>
                        <%var count=1;if(len1>=len2){el.itemList.map(function(item,index){if(index===0)return;var emps=el.marketEmpList[count];var empConsume,empConsumeComission;if(emps){empConsume=(emps.empConsume!='*'?miliFormat(((emps.empConsume-0).toFixed(2)-0)):emps.empConsume);empConsumeComission=(emps.empConsumeComission!='*'?miliFormat(((emps.empConsumeComission-0).toFixed(2)-0)):emps.empConsumeComission);}%>
                            <tr class="<%=experienceCard%>">
                                <td class="text">
                                    <%=(item.itemName)%>
                                </td>
                                <td class="num">
                                    <%=(item.orderNum)%>
                                </td>
                                <td class="num">
                                    <%=miliFormat(((item.price-0).toFixed(2)-0))%>
                                </td>
                                <%if(emps&&(indexing[count].index===index)){var v=indexing[count].value;%>
                                    <td class="text" rowspan="<%=v%>">
                                        <%=(emps.empName)%>
                                    </td>
                                    <td class="text" rowspan="<%=v%>">
                                        <%=(emps.postType)%>
                                    </td>
                                    <td class="num" rowspan="<%=v%>">
                                        <%=empConsume%>
                                    </td>
                                    <td class="num" rowspan="<%=v%>">
                                        <%=empConsumeComission%>
                                    </td>
                                    <%count++;}%>
                            </tr>
                            <%});}else{count=1;el.marketEmpList.map(function(emps,index){if(index===0)return;var item=el.itemList[count];%>
                                <tr class="<%=experienceCard%>">
                                    <%if(item&&(indexing[count].index===index)){var v=indexing[count].value;%>
                                        <td class="text" rowspan="<%=v%>">
                                            <%=(item.itemName)%>
                                        </td>
                                        <td class="num" rowspan="<%=v%>">
                                            <%=(item.orderNum)%>
                                        </td>
                                        <td class="num" rowspan="<%=v%>">
                                            <%=(item?miliFormat(((item.price-0).toFixed(2)-0)):'')%>
                                        </td>
                                        <%count++}%>
                                            <td class="text">
                                                <%=(emps.empName)%>
                                            </td>
                                            <td class="text">
                                                <%=(emps.postType)%>
                                            </td>
                                            <td class="num">
                                                <%=(emps.empConsume!="*"?miliFormat(((emps.empConsume-0).toFixed(2)-0)):emps.empConsume)%>
                                            </td>
                                            <td class="num">
                                                <%=(emps.empConsumeComission!="*"?miliFormat(((emps.empConsumeComission-0).toFixed(2)-0)):emps.empConsumeComission)%>
                                            </td>
                                </tr>
                                <%})}});%>
                </tbody>
        </table>
    </script>
    <!--end订单明细-->
    <!--start营业报表-->
    <script type="text/template" id="reportStore-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="multi-header">
                <% var headerList= eval('(' + window.localStorage.getItem("businessHeader") + ')'); %>
                    <tr>
                        <th rowspan="2" class="fixed-coloum-header">日期</th>
                        <th colspan="3" text-center>客流</th>
                        <th colspan="3" text-center>销售收入</th>
                        <th colspan="4" text-center>销售业绩</th>
                        <th colspan="3" text-center>消耗业绩</th>
                        <th rowspan="2" class="sortable" data-sort="totalStroeSales">销售合计</th>
                        <th rowspan="2" class="sortable" data-sort="totalStoreConsume">消耗合计</th>
                        <th colspan="5" text-center>赠送</th>
                        <th colspan="<%=headerList.length%>" text-center>支付方式</th>
                        <th rowspan="2">备注</th>
                    </tr>
                    <tr>
                        <th>项目量</th>
                        <th>到访人次</th>
                        <th class="sortable" data-sort="newNumber">新增新客</th>
                        <th>现金</th>
                        <th>赠送</th>
                        <th class="sortable" data-sort="payTotal">总计</th>

                        <th>充值</th>
                        <th>卡项</th>
                        <th>单次体验</th>
                        <th>商品</th>

                        <th>耗卡</th>
                        <th>现金体验</th>
                        <th>商品</th>

                        <th>充值</th>
                        <th>卡项</th>
                        <th>服务项目</th>
                        <th>商品</th>
                        <th>合计</th>
                        <% headerList.map(function(el,index){%>
                            <!--<th>支付宝</th>
                    <th>京东支付</th>
                    <th>微信支付</th>
                    <th>招联支付</th>
                    <th>百度钱包</th>
                    <th>QQ钱包</th>
                    <th>其他支付</th>
                    <th>线上支付合计</th>-->
                            <th>
                                <%=el.name%>
                            </th>
                            <%});%>
                    </tr>

            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text first-coloum-flag"><!-- 日期 -->
                            <%=el.date%>
                        </td>
                        <td class="num" v-label="项目量"> 
                            <%=el.productNum%>
                        </td>
                        <td class="num" v-label="到访人次">
                            <%=el.pNumber%>
                        </td>
                        <td class="num" v-label="新增新客">
                            <%=el.newNumber%>
                        </td>


                        <td class="num" v-label="现金">
                            <%=miliFormat(((el.cashPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="赠送">
                            <%=miliFormat(((el.presentPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="总计"><!-- 总计 -->
                            <%=miliFormat(((el.payTotal-0).toFixed(2)-0))%>
                        </td>


                        <td class="num" v-label="充值">
                            <%=miliFormat(((el.rechargeAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="卡项">
                            <%=miliFormat(((el.cardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="单次体验">
                            <%=miliFormat(((el.serviceAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="商品">
                            <%=miliFormat(((el.cosmeticsAmount-0).toFixed(2)-0))%>
                        </td>


                        <td class="num" v-label="耗卡"> 
                            <%=miliFormat(((el.cardConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="现金体验">
                            <%=miliFormat(((el.experienceConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="商品">
                            <%=miliFormat(((el.cosmeticsConsume-0).toFixed(2)-0))%>
                        </td>

                        <td class="num" v-label="销售合计"> 
                            <%=miliFormat(((el.totalStroeSales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="消耗合计">
                            <%=miliFormat(((el.totalStoreConsume-0).toFixed(2)-0))%>
                        </td>


                        <td class="num" v-label="充值">
                            <%=miliFormat(((el.rechargeGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="卡项">
                            <%=miliFormat(((el.cardGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="服务项目">
                            <%=miliFormat(((el.serviceGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="商品">
                            <%=miliFormat(((el.cosmeticsGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num" v-label="合计">
                            <%=miliFormat(((el.giftSum-0).toFixed(2)-0))%>
                        </td>

                        <!--<td class="num">
                            <%=miliFormat(((el.aliPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.jdPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.wxPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.zlPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.bAIDUPAY-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.qQPAY-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.otherOnlinePay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.onlinePay-0).toFixed(2)-0))%>
                        </td>-->
                        <%el.pmList.map(function(e,index){%>
                            <td class="num">
                                <%=miliFormat(((e.amount-0).toFixed(2)-0))%>
                            </td>
                            <%});%>
                                <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end营业报表-->



    <!--start分类汇总-->
    <script type="text/template" id="reportCategory-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consumes">消耗业绩</th>
                    <th>备注</th>
                    <th td-more></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <%
                                if(el.classType == '1'){
                                        %>
                        <tr data-id="<%=el.id%>" data-name="<%=el.name%>" style="cursor: pointer;">
                            <%
                                }else{
                                        %>
                                <tr>
                                    <%
                                }
                      %>
                                        <td class="text">
                                            <%=el.name%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat((el.sales-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat((el.consumes-0))%>
                                        </td>


                                        <td class="text">-</td>
                                        <td text-center td-more>
                                            <%
                                            if(el.classType == '1'){
                                                    %>
                                                <i class="iconfont">&#xe6a7;</i>
                                                <%
                                            }
                            %>
                                        </td>
                                </tr>
                                <%});%>
            </tbody>
        </table>
    </script>
    <!--end分类汇总-->
    <!--start分类详情汇总-->
    <script type="text/template" id="reportNextCategory-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consumes">消耗业绩</th>
                    <th>备注</th> 
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <%
                                if(el.classType == '1'){
                                        %>
                        <tr data-id="<%=el.id%>" data-name="<%=el.name%>" style="cursor: pointer;">
                            <%
                                }else{
                                        %>
                                <tr>
                                    <%
                                }
                      %>
                                        <td class="text">
                                            <%=el.name%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat((el.sales-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat((el.consumes-0))%>
                                        </td> 
                                        <td class="text">-</td> 
                                </tr>
                                <%});%>
            </tbody>
        </table>
    </script>
    <!--end分类详情汇总-->


    <!--start客户项卡项负债-->
    <script type="text/template" id="reportCustomerCard-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="moreinfo">
                <tr>
                    <th>编号</th>
                    <th>姓名</th>
                    <th class="sortable" data-sort="totalNumber">购买数量</th>
                    <th class="sortable" data-sort="totalTimes">总次数</th>
                    <th class="sortable" data-sort="totalRestTimes">剩余次数</th>
                    <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                    <th>所属门店</th>
                    <th style="text-align:center;width:60px !important;min-width:60px !important;max-width:240px;">备注</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody moreinfo">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.id%>" data-name="<%=el.customerName%>">
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalRestTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td>
                            <%=el.storeName%>
                        </td>
                        <td style="text-align:center;width:60px !important;min-width:60px !important;max-width:240px;">-</td>
                        <td style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"><i class="iconfont">&#xe6a7;</i></td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户项卡项负债-->
    <!--start客户项卡项负债明细报表-->
    <script type="text/template" id="reportCustomerCardDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="">
                <tr>
                    <th>编号</th>
                    <th>姓名</th>
                    <th>项目名称</th>
                    <th>购买时间</th>
                    <th class="sortable" data-sort="totalNumber">购买数量</th>
                    <th class="sortable" data-sort="totalTimes">总次数</th>
                    <th class="sortable" data-sort="totalRestTimes">剩余次数</th>
                    <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                    <th>所属门店</th>
                    <th>最后使用时间</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.cardName%>
                        </td>
                        <td class="text">
                            <%=el.date%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalTimes-0))%>
                        </td>
                        <td class="num">
                            <%= el.totalRestTimes >= 9999 ? '∞':miliFormat((el.totalRestTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td class="text">
                            <%=el.latest%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户项卡项负债明细报表-->
    <!-- start 品牌营业报表 -->
    <script type="text/template" id="reportBrand-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="multi-header">
                <tr>
                    <th rowspan="2" class="fixed-coloum-header">门店名称</th>
                    <th colspan="3" text-center>客流</th>
                    <th colspan="4" text-center>销售收入</th>
                    <th colspan="4" text-center>销售业绩</th>
                    <th colspan="3" text-center>消耗业绩</th>
                    <th rowspan="2" class="sortable" data-sort="totalStroeSales">销售合计</th>
                    <th rowspan="2" class="sortable" data-sort="totalStoreConsume">消耗合计</th>
                    <th colspan="5" text-center>赠送</th>
                    <th rowspan="2">备注</th>
                </tr>
                <tr>
                    <th>到访人头</th>
                    <th>到访人次</th>
                    <th class="sortable" data-sort="newNumber">新增新客</th>
                    <th>现金</th>
                    <th>银联</th>
                    <th>线上</th>
                    <th class="sortable" data-sort="payTotal">总计</th>
                    <th>充值</th>
                    <th>卡项</th>
                    <th>单次体验</th>
                    <th>商品</th>
                    <th>耗卡</th>
                    <th>现金体验</th>
                    <th>商品</th>
                    <th>充值</th>
                    <th>卡项</th>
                    <th>服务项目</th>
                    <th>商品</th>
                    <th>合计</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text first-coloum-flag">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=el.headNumber%>
                        </td>
                        <td class="num">
                            <%=el.pNumber%>
                        </td>
                        <td class="num">
                            <%=el.newNumber%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cashPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.bankPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.onlinePay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.payTotal-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.rechargeAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.serviceAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cosmeticsAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cardConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.experienceConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cosmeticsConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.totalStroeSales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.totalStoreConsume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.rechargeGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cardGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.serviceGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.cosmeticsGift-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.giftSum-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!-- end 品牌营业报表 -->

    <script type="text/template" id="reportBrandCategory-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consumes">消耗业绩</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.sales-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.consumes-0))%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <script type="text/template" id="reportBrandProduct-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>名称</th>
                    <th>类型</th>
                    <th class="sortable" data-sort="price">销售单价</th>
                    <th class="sortable" data-sort="sellNumber">销售数量</th>
                    <th class="sortable" data-sort="consumeNumber">消耗次数</th>
                    <th class="sortable" data-sort="sales">销售业绩</th>
                    <th class="sortable" data-sort="consumes">消耗业绩</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="text">
                            <%=el.productType%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.price-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sellNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumeNumber-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consumes-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>

    <script type="text/template" id="reportBrandCard-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>项目卡名称</th>
                    <th class="sortable" data-sort="totalNumber">数量</th>
                    <th class="sortable" data-sort="totalTimes">总次数</th>
                    <th class="sortable" data-sort="totalRestTimes">剩余次数</th>
                    <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalNumber-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.totalRestTimes-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>


    <!--start阶梯提成-->
    <script type="text/template" id="reportRcommission-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>姓名</th>
                    <th>员工类型</th>
                    <th class="sortable" data-sort="amount">提成金额</th>
                    <th>开始结算时间</th>
                    <th>结束结算时间</th>
                    <th>所属门店</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.empName%>
                        </td>
                        <td class="text">
                            <%=el.postName%>
                        </td>
                        <td class="num">
                            <%=miliFormat((el.amount-0))%>
                        </td>
                        <td class="text">
                            <%=el.sTime%>
                        </td>
                        <td class="text">
                            <%=el.eTime%>
                        </td>
                        <td class="text">
                            <%=el.storeName%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end阶梯提成-->
    <!-- start 区域星级评分 -->
    <script type="text/template" id="areaReportEvalute-tpl">
        <%
                        var temp = !data[0] ? {} : data[0];
             %>
            <table id="fixTable" class="table table-bordered p4-table">
                <thead class="">
                    <tr class="head-nodata">
                        <th padding-left-right>
                            <%= temp.lv=='0' ? '员工名称' :'组织名称' %>
                        </th>
                        <th class="sortable" data-sort="eValue">评分</th>
                        <th class="sortable" data-sort="eCount">数量</th>
                        <th text-center>截止日期</th>
                        <th text-center>备注</th>
                        <th td-more></th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){%>
                        <tr data-id="<%=el.id%>" data-value="<%=el.eValue%>" data-name="<%=el.name%>" data-lv="<%=el.lv%>">
                            <td class="text" padding-left-right>
                                <%=el.name%>
                            </td>
                            <td class="num" text-center>
                                <%=el.eValue%>
                            </td>
                            <td class="num" text-center>
                                <%=miliFormat(el.eCount)%>
                            </td>
                            <td class="text" text-center>
                                <%=el.date%>
                            </td>
                            <td>-</td>
                            <td text-center td-more><i class="iconfont">&#xe6a7;</i></td>
                        </tr>
                        <%});%>
                </tbody>
            </table>
    </script>
    <!-- end 区域星级评分 -->
    <!--start区域营业报表-->
    <script type="text/template" id="areaReportBusiness-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead class="multi-header">
                <% var headerList= eval('(' + window.localStorage.getItem("businessHeader") + ')'); %>
                    <tr>
                        <th rowspan="2" class="fixed-coloum-header">组织名称</th>
                        <th colspan="3" text-center>客流</th>
                        <th colspan="3" text-center>销售收入</th>
                        <th colspan="4" text-center>销售业绩</th>
                        <th colspan="3" text-center>消耗业绩</th>
                        <th rowspan="2" class="sortable" data-sort="totalStroeSales">销售合计</th>
                        <th rowspan="2" class="sortable" data-sort="totalStoreConsume">消耗合计</th>
                        <th colspan="5" text-center>赠送</th>
                        <th colspan="<%=headerList.length%>" text-center>支付方式</th>
                        <th rowspan="2">备注</th>
                        <th td-more rowspan="2"></th>
                    </tr>
                    <tr>
                        <th>项目量</th>
                        <th>到访人次</th>
                        <th class="sortable" data-sort="newNumber">新增新客</th>

                        <th>现金</th>
                        <th>赠送</th>
                        <th class="sortable" data-sort="payTotal">总计</th>
                        <th>充值</th>
                        <th>卡项</th>
                        <th>单次体验</th>
                        <th>商品</th>
                        <th>耗卡</th>
                        <th>现金体验</th>

                        <th>商品</th>
                        <th>充值</th>
                        <th>卡项</th>
                        <th>服务项目</th>
                        <th>商品</th>
                        <th>合计</th>

                        <% headerList.map(function(el,index){%>
                            <!--<th>支付宝</th>
                    <th>京东支付</th>
                    <th>招联支付</th>
                    <th>微信支付</th>
                    <th>百度钱包</th>
                    <th>QQ钱包</th>
                    <th>其他支付</th>
                    <th>线上支付合计</th>-->

                            <!--<th>合计</th>-->
                            <th>
                                <%=el.name%>
                            </th>
                            <%});%>
                    </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <%
                                if(el.lv != '0'){
                                        %>
                        <tr data-id="<%=el.pid%>" data-name="<%=el.pname%>" data-lv="<%=el.lv%>" style="cursor: pointer;">
                            <%
                                }else{
                                        %>
                                <tr>
                                    <%
                                }
                      %>

                                        <td class="text first-coloum-flag">
                                            <%=el.pname%>
                                        </td>
                                        <td class="num">
                                            <%=el.productNum%>
                                        </td>
                                        <td class="num">
                                            <%=el.pNumber%>
                                        </td>
                                        <td class="num">
                                            <%=el.newNumber%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cashPay-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.presentPay-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.payTotal-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.rechargeAmount-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cardAmount-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.serviceAmount-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cosmeticsAmount-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cardConsume-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.experienceConsume-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cosmeticsConsume-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.totalStroeSales-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.totalStoreConsume-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.rechargeGift-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cardGift-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.serviceGift-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.cosmeticsGift-0).toFixed(2)-0))%>
                                        </td>
                                        <td class="num">
                                            <%=miliFormat(((el.giftSum-0).toFixed(2)-0))%>
                                        </td>

                                        <!--<td class="num">
                            <%=miliFormat(((el.aliPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.jdPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.zlPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.wxPay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.bAIDUPAY-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.qQPAY-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.otherOnlinePay-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.onlinePay-0).toFixed(2)-0))%>
                        </td>-->
                                        <%el.pmList.map(function(e,index){%>
                                            <td class="num">
                                                <%=miliFormat(((e.amount-0).toFixed(2)-0))%>
                                            </td>
                                            <%});%>
                                                <td class="text">-</td>
                                                <td text-center td-more>
                                                    <%
                                            if(el.lv != '0'){
                                                    %>
                                                        <i class="iconfont">&#xe6a7;</i>
                                                        <%
                                            }
                            %>
                                                </td>
                                </tr>
                                <%});%>
            </tbody>
        </table>
    </script>
    <!--start 区域分类汇总-->
    <script type="text/template" id="areaReportCategory-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <%var temp = !data[0] ? {} : data[0];%>
                <thead>
                    <tr>
                        <th>分类名称</th>
                        <th>
                            <%= temp.lv=='0' ? '门店名称' :'组织名称' %>
                        </th>
                        <th class="sortable" data-sort="sales">销售业绩</th>
                        <th class="sortable" data-sort="consumes">消耗业绩</th>
                        <th text-center>备注</th>
                        <th td-more text-center></th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){%>
                        <%
                                if(el.lv != '0'){
                                        %>
                            <tr data-orgid="<%=el.orgId%>" data-id="<%=el.id%>" data-name="<%=el.orgName%>" data-lv="<%=el.lv%>">
                                <%
                                }else{
                                        %>
                                    <tr>
                                        <%
                                }
                      %>
                                            <td class="text">
                                                <%=el.name%>
                                            </td>
                                            <td class="text">
                                                <%=el.orgName%>
                                            </td>

                                            <td class="num">
                                                <%=miliFormat((el.sales-0))%>
                                            </td>
                                            <td class="num">
                                                <%=miliFormat((el.consumes-0))%>
                                            </td>
                                            <td class="text" text-center>-</td>
                                            <td text-center td-more>
                                                <%
                                            if(el.lv != '0'){
                                                    %>
                                                    <i class="iconfont">&#xe6a7;</i>
                                                    <%
                                            }
                            %>
                                            </td>
                                    </tr>
                                    <%});%>
                </tbody>
        </table>
    </script>
    <!--end 区域分类汇总-->

    <!--start区域卡项负债-->
    <script type="text/template" id="areaReportCard-tpl">
        <%var temp = !data[0] ? {} : data[0];%>
            <table id="fixTable" class="table table-bordered p4-table">
                <thead>
                    <tr>
                        <th>项目卡名称</th>
                        <th>
                            <%= temp.lv=='0' ? '门店名称' :'组织名称' %>
                        </th>
                        <th class="sortable" data-sort="totalNumber">数量</th>
                        <th class="sortable" data-sort="totalTimes">总次数</th>
                        <th class="sortable" data-sort="totalUsedTimes">剩余次数</th>
                        <th class="sortable" data-sort="restCardAmount">未消耗金额</th>
                        <th td-more>备注</th>
                        <th td-more text-center></th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){%>
                        <tr data-id="<%=el.orgId%>" data-name="<%=el.name%>" data-orgname="<%=el.orgName%>" data-lv="<%=el.lv%>">
                            <td class="text">
                                <%=el.name%>
                            </td>
                            <td class="text">
                                <%=el.orgName%>
                            </td>
                            <td class="num">
                                <%=miliFormat((el.totalNumber-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat((el.totalTimes-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat((el.totalRestTimes-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.restCardAmount-0).toFixed(2)-0))%>
                            </td>
                            <td class="text">-</td>
                            <td text-center td-more><i class="iconfont">&#xe6a7;</i></td>
                        </tr>
                        <%});%>
                </tbody>
            </table>
    </script>
    <!--end区域卡项负债-->
    <!--start区域产品汇总报表-->
    <script type="text/template" id="areaReportProduct-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <%var temp = !data[0] ? {} : data[0];%>
                <thead>
                    <tr>
                        <th>产品名称</th>
                        <th>
                            <%= temp.lv=='0' ? '门店名称' :'组织名称' %>
                        </th>
                        <th>产品类型</th>
                        <th class="sortable" data-sort="price">销售单价</th>
                        <th class="sortable" data-sort="sellNumber">销售数量</th>
                        <th class="sortable" data-sort="consumeNumber">消耗次数</th>
                        <th class="sortable" data-sort="sales">销售业绩</th>
                        <th class="sortable" data-sort="consumes">消耗业绩</th>
                        <th>备注</th>
                        <th td-more text-center></th>
                    </tr>
                </thead>
                <tbody id="tb" class="tbody">
                    <%data.map(function(el,index){%>

                        <!-- <%
                                if(el.lv != '0'){
                                        %>  -->
                        <tr data-orgid="<%=el.orgId%>" data-id="<%=el.id%>" data-name="<%=el.name%>" data-orgname="<%=el.orgName%>" data-lv="<%=el.lv%>">
                            <!-- <%
                                }else{
                                        %>
                                    <tr>
                                        <%
                                }
                      %>  -->

                            <td class="text">
                                <%=el.name%>
                            </td>
                            <td class="text">
                                <%=el.orgName%>
                            </td>
                            <td class="text">
                                <%=el.productType%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.price-0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.sellNumber-0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.consumeNumber-0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                            </td>
                            <td class="num">
                                <%=miliFormat(((el.consumes-0).toFixed(2)-0))%>
                            </td>
                            <td class="text">-</td>
                            <td text-center td-more>
                                <!-- <%
                                            if(el.lv != '0'){
                                                    %> -->
                                <i class="iconfont">&#xe6a7;</i>
                                <!-- <%
                                            }
                            %> -->
                            </td>
                        </tr>
                        <%});%>
                </tbody>
        </table>
    </script>
    <!--end区域产品汇总报表-->
    <!--start到店排行-->
    <script type="text/template" id="reportCustomerArrive-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>客户名称</th>
                    <th>会员编号</th>
                    <th>客户类型</th>
                    <th class="sortable" data-sort="arriveCount">到店次数</th>
                    <th>手机号码</th>
                    <th>最近到店</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.memberType%>
                        </td>
                        <td class="num">
                            <%=el.arriveCount%>
                        </td>
                        <td class="text">
                            <%=el.telphone%>
                        </td>
                        <td class="text">
                            <%=el.latest%>
                        </td>
                        <td class="text">-</td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end到店排行-->

    <!--start品牌体验券-->
    <script type="text/template" id="reportBrandCoupons-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>授权门店</th>
                    <th>体验券名</th>
                    <!--<th>号段</th>-->
                    <th>兑换数量</th>
                    <th td-more text-center></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <%
                                    if(el.useCount != '0'){
                                            %>
                        <tr data-id="<%=el.orgId%>" data-couponid="<%=el.couponId%>" data-name="<%=el.couponName%>" style="cursor: pointer;">
                            <%
                                    }else {
                                        %>
                                <tr>
                                    <%
                                    }
                    %>

                                        <td class="text">
                                            <%=el.orgName%>
                                        </td>
                                        <td class="text">
                                            <%=el.couponName%>
                                        </td>
                                        <!--<td class="num">
                                            <%=el.code%>
                                        </td>-->
                                        <td class="num">
                                            <%=el.useCount%>
                                        </td>
                                        <td text-center td-more>
                                            <%
                                            if(el.useCount != '0'){
                                                    %>
                                                <i class="iconfont">&#xe6a7;</i>
                                                <%
                                            }
                            %>
                                        </td>
                                </tr>
                                <%});%>
            </tbody>
        </table>
    </script>
    <!--end品牌体验券-->

    <!--start门店体验券-->
    <script type="text/template" id="reportStoreCoupons-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <!--<th>授权门店</th>-->
                    <th>体验券名</th>
                    <!--<th>号段</th>-->
                    <th>兑换数量</th>
                    <th td-more text-center></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <%
                                    if(el.useCount != '0'){
                                            %>
                        <tr data-id="<%=el.couponId%>" data-name="<%=el.couponName%>" style="cursor: pointer;">
                            <%
                                    }else {
                                        %>
                                <tr>
                                    <%
                                    }
                    %>
                                        <!--<td class="text">
                                            <%=el.orgName%>
                                        </td>-->
                                        <td class="text">
                                            <%=el.couponName%>
                                        </td>
                                        <!--<td class="num">
                                            <%=el.code%>
                                        </td>-->
                                        <td class="num">
                                            <%=el.useCount%>
                                        </td>
                                        <td text-center td-more>
                                            <%
                                            if(el.useCount != '0'){
                                                    %>
                                                <i class="iconfont">&#xe6a7;</i>
                                                <%
                                            }
                            %>
                                        </td>
                                </tr>
                                <%});%>
            </tbody>
        </table>
    </script>
    <!--end门店体验券-->

    <!--start门店体验券详情-->
    <script type="text/template" id="reportStoreCouponsDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>优惠券号</th>
                    <th>兑换会员</th>
                    <th>兑换门店</th>
                    <th>兑换日期</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.code%>
                        </td>
                        <td class="num">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.orgName%>
                        </td>
                        <td class="text">
                            <%=el.date%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end门店体验券详情-->

    <!--start门店体验券消耗详情-->
    <script type="text/template" id="reportStoreCouponsConsumeDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>体验券名称</th>
                    <th>体验券编号</th>
                    <th>体验劵状态</th>
                    <!--<th>指派人</th>-->
                    <!--<th>授权门店</th>-->
                    <th>消费门店</th>
                    <th>单据日期</th>
                    <th>单据编号</th>
                    <th>会员姓名</th>
                    <th>产品名称</th>
                    <th>产品编号</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.id%>">
                        <td class="text">
                            <%=el.couponName%>
                        </td>
                        <td class="num">
                            <%=el.couponCode%>
                        </td>
                        <td class="text">
                            <%=el.statusName%>
                        </td>
                        <!--<td class="text">
                            <%=el.empName%>
                        </td>-->
                        <!--<td class="text">
                            <%=el.empowerName%>
                        </td>-->
                        <td class="text">
                            <%=el.consumName%>
                        </td>
                        <td class="num">
                            <%=el.orderStart%>
                        </td>
                        <td class="num" style="max-width:280px;">
                            <%=el.orderCode%>
                        </td>
                        <td class="text">
                            <%=el.userName%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="num">
                            <%=el.productCode%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end门店体验券消耗详情-->

    <!--start客户来源-->
    <script type="text/template" id="reportCustomerSource-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>来源类型</th>
                    <th class="sortable" data-sort="sales">销售</th>
                    <th class="sortable" data-sort="consume">消耗</th>
                    <th class="sortable" data-sort="num">数量</th>
                    <th>备注</th>
                    <th td-more text-center></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.id%>" data-name="<%=el.name%>">
                        <td class="text">
                            <%=el.name%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.sales-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=miliFormat(((el.consume-0).toFixed(2)-0))%>
                        </td>
                        <td class="num">
                            <%=el.num%>
                        </td>
                        <td class="text">-</td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i> </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户来源-->
    <!--start取货报表-->
    <script type="text/template" id="reportTakeGoods-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>产品名称</th>
                    <th>门店</th>
                    <th>品类</th>
                    <th>规格</th>
                    <th>单位</th>
                    <th>销售数量</th>
                    <th>已取货数量</th>
                    <th>剩余数量</th>
                    <th td-more text-center></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.productId%>" data-name="<%=el.productName%>" data-organizationId="<%=el.organizationId%>" data-store="<%=el.organizationName%>">
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.typeName%>
                        </td>
                        <td class="text">
                            <%=el.spec%>
                        </td>
                        <td class="text">
                            <%=el.unitName%>
                        </td>
                        <td class="num">
                            <%=el.quantity%>
                        </td>
                        <td class="num">
                            <%=el.pickQuantity%>
                        </td>
                        <td class="num">
                            <%=el.suplusQuantity%>
                        </td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i> </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end取货报表-->
    <!--start取货报表详情-->
    <script type="text/template" id="reportTakeGoodsDetail-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>编号</th>
                    <th>会员姓名</th>
                    <th>购买日期</th>
                    <th>单号</th>
                    <th>销售数量</th>
                    <th>销售金额</th>
                    <th>取货数量</th>
                    <th>剩余数量</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.billCode%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.buyTime%>
                        </td>
                        <td class="text">
                            <%=el.orderCode%>
                        </td>
                        <td class="num">
                            <%=el.quantity%>
                        </td>
                        <td class="num">
                            <%=el.money%>
                        </td>
                        <td class="num">
                            <%=el.pickQuantity%>
                        </td>
                        <td class="num">
                            <%=el.suplusQuantity%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end取货报表详情-->
    <!--start客户临时转店消费记录-->
    <script type="text/template" id="customerTransOrdersReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>客户编号</th>
                    <th>客户姓名</th>
                    <th>转出门店</th>
                    <th>转入门店</th>
                    <th>销售金额</th>
                    <th>消耗金额</th>
                    <th>转店日期</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.customerId%>" data-storeid="<%=el.targetOrgId%>" data-time="<%=el.transTime%>">
                        <td class="text">
                            <%=el.memberNo%>
                        </td>
                        <td class="text">
                            <%=el.customerName%>
                        </td>
                        <td class="text">
                            <%=el.sourceOrgName%>
                        </td>
                        <td class="text">
                            <%=el.targetOrgName%>
                        </td>
                        <td class="num">
                            <%=el.sales%>
                        </td>
                        <td class="num">
                            <%=el.consume%>
                        </td>
                        <td class="text">
                            <%=el.transTime%>
                        </td>
                        <%if(device().isMobile){%>
                            <td style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"><i class="iconfont">&#xe6a7;</i></td>
                            <%}else if(!excle){%>
                                <td class="text"><a class="emp-detailBtn" data-role="sale" style="color: #d6ae76;display: inline-block;border: 1px solid #e4cdae;border-radius: 4px;padding: 2px 4px;">销售详情<i class="iconfont">&#xe629;</i></a>
                                    <a class="emp-detailBtn" data-role="consume" style="color: #d6ae76;display: inline-block;border: 1px solid #e4cdae;border-radius: 4px;padding: 2px 4px;margin-left: 6px;">消耗详情<i class="iconfont">&#xe629;</i></a>
                                </td>
                                <%}%>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户临时转店消费记录-->
    <!--start库存报表-->
    <script type="text/template" id="totalInventoryReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>门店</th>
                    <th>产品编号</th>
                    <th>产品名称</th>
                    <th>品类</th>
                    <th>期初数量</th>
                    <th>本月入库数</th>
                    <th>本月出库数</th>
                    <th>库存数量</th>
                    <th>欠货数量</th>
                    <th>实际库存数量</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){

                    %>
                    <tr data-id="<%=el.productId%>" data-name="<%=el.productName%>">
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.numberCode%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="text">
                            <%=el.categoryName%>
                        </td>
                        <td class="num">
                            <%=el.beginNum%>
                        </td>
                        <td class="num">
                            <%=el.entryNum%>
                        </td>
                        <td class="num">
                            <%=el.deliveryNum%>
                        </td>
                        <td class="num">
                            <%=el.restNum%>
                            <%=el.consumeUnitName || ''%>
                            <span style="font-size:12px;color:#797878">
                                <%=el.consumeAmount ? '('+el.consumeAmount+')' : ''%>
                            </span>
                        </td>
                        <td class="num">
                            <%=el.surplusQuantity%>
                        </td>
                        <td class="num">
                            <%=el.realRestNum%>
                        </td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i> </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end 库存报表-->
    <!--start 库存报表详情-->
    <script type="text/template" id="inventoryDetailReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>交易类别</th>
                    <th>门店</th>
                    <th>单据编号</th>
                    <th>单据日期</th>
                    <th>产品单位</th>
                    <th>交易数量</th>
                    <th>仓库</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.orderType%>
                        </td>
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.orderNo%>
                        </td>
                        <td class="text">
                            <%=el.orderDate%>
                        </td>
                        <td class="text">
                            <%=el.unitName%>
                        </td>
                        <td class="text">
                            <%=el.quantity%>
                        </td>
                        <td class="text">
                            <%=el.storageName%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end 库存报表详情-->
    <!--start 分仓库库存报表-->
    <script type="text/template" id="storageInventoryReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>门店</th>
                    <th>产品名称</th>
                    <th>产品品类</th>
                    <th>仓库</th>
                    <th>期初数量</th>
                    <th>本月入库数</th>
                    <th>本月出库数</th>
                    <th>库存数量</th>
                    <th style="text-align:center;width:30px !important;min-width:30px !important;max-width:40px;"></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.productId%>" data-storageid="<%=el.storageId%>" data-name="<%=el.productName%>">
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="text">
                            <%=el.categoryName%>
                        </td>
                        <td class="text">
                            <%=el.storageName%>
                        </td>
                        <td class="num">
                            <%=el.beginNum%>
                        </td>
                        <td class="num">
                            <%=el.entryNum%>
                        </td>
                        <td class="num">
                            <%=el.deliveryNum%>
                        </td>
                        <td class="num">
                            <%=el.restNum%>
                            <%=el.consumeUnitName || ''%>
                            <span style="font-size:12px;color:#797878">
                                <%=el.consumeAmount ? '('+el.consumeAmount+')' : ''%>
                            </span>
                        </td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i> </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end 分仓库库存报表-->
    <!--start 分仓库库存报表详情-->
    <script type="text/template" id="storageInventoryDetailReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>交易类别</th>
                    <th>门店</th>
                    <th>单据编号</th>
                    <th>单据日期</th>
                    <th>产品单位</th>
                    <th>交易数量</th>
                    <th>仓库</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.orderType%>
                        </td>
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.orderNo%>
                        </td>
                        <td class="text">
                            <%=el.orderDate%>
                        </td>
                        <td class="text">
                            <%=el.unitName%>
                        </td>
                        <td class="text">
                            <%=el.quantity%>
                        </td>
                        <td class="text">
                            <%=el.storageName%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end 分仓库库存报表详情-->
    <!--start 产品交易查询报表详情-->
    <script type="text/template" id="goodsTradeReport-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr>
                    <th>门店</th>
                    <th>单据编号</th>
                    <th>单据日期</th>
                    <th>交易类别</th>
                    <th>产品编号</th>
                    <th>产品名称</th>
                    <th>产品品类</th>
                    <th>产品单位</th>
                    <th>交易数量</th>
                    <th>仓库</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr>
                        <td class="text">
                            <%=el.organizationName%>
                        </td>
                        <td class="text">
                            <%=el.orderNo%>
                        </td>
                        <td class="text">
                            <%=el.orderDate%>
                        </td>
                        <td class="text">
                            <%=el.orderType%>
                        </td>

                        <td class="text">
                            <%=el.numberCode%>
                        </td>
                        <td class="text">
                            <%=el.productName%>
                        </td>
                        <td class="text">
                            <%=el.categoryName%>
                        </td>

                        <td class="text">
                            <%=el.unitName%>
                        </td>
                        <td class="text">
                            <%=el.quantity%>
                        </td>
                        <td class="text">
                            <%=el.storageName%>
                        </td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end 产品交易查询报表详情-->

    <!--start客户欠款统计-->
    <script type="text/template" id="customerArrearByDate-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="head-nodata">
                    <th>客户姓名</th>
                    <th class="sortable" data-sort="rest">欠款金额</th>
                    <th>组织名称</th>
                    <th td-more></th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){%>
                    <tr data-id="<%=el.customerId%>" data-name="<%=el.name%>">
                        <td class="text" padding-left-right>
                            <%=el.name%>
                        </td>
                        <td class="num" text-center>
                            <%=miliFormat(((el.rest-0).toFixed(2)-0))%>
                        </td>
                        <td class="text" text-center>
                            <%=el.storeName%>
                        </td>
                        <td text-center td-more><i class="iconfont">&#xe6a7;</i></td>
                    </tr>
                    <%});%>
            </tbody>
        </table>
    </script>
    <!--end客户欠款统计-->


    <!--start赠送统计-->
    <script type="text/template" id="reportGift-tpl">
        <table id="fixTable" class="table table-bordered p4-table">
            <thead>
                <tr class="multi-header">
                    <th rowspan="2" class="fixed-coloum-header">客户姓名</th>
                    <th rowspan="2">客户编号</th>
                    <th rowspan="2">客户类型</th>
                    <th rowspan="2">日期</th>
                    <th rowspan="2">产品</th>
                    <th rowspan="2">产品分类</th>
                    <th rowspan="2" class="sortable" data-sort="orderNum" >数量</th>
                    <th rowspan="2" class="sortable" data-sort="price">单价</th>
                    <th rowspan="2" class="sortable" data-sort="giftMoney">赠送金额</th>
                    <th colspan="4">参与员工提成及业绩</th>
                    <th rowspan="2">门店</th>
                    <th rowspan="2">单号</th>
                </tr>
                <tr>
                    <th>员工姓名</th>
                    <th>职位</th>
                    <th>销售业绩</th>
                    <th>销售提成</th>
                </tr>
            </thead>
            <tbody id="tb" class="tbody">
                <%data.map(function(el,index){
                    var v = el.empList[0] || {};
                    var len = el.empList.length === 0 ? 1 : el.empList.length;
                    var empList = el.empList.slice(1);
                %> 
                    <tr>
                        <td rowspan="<%=len%>" class="first-coloum-flag"><%=el.customerName%></td>
                        <td rowspan="<%=len%>"><%=el.customerNo%></td>
                        <td rowspan="<%=len%>"><%=el.customerType%></td>
                        <td rowspan="<%=len%>"><%=el.date%></td>
                        <td rowspan="<%=len%>" title="<%=el.productName%>"><%=el.productName%></td>
                        <td rowspan="<%=len%>"><%=el.categoryName%></td>
                        <td rowspan="<%=len%>" class="num"><%=el.orderNum%></td>
                        <td rowspan="<%=len%>" class="num"><%=el.price%></td>
                        <td rowspan="<%=len%>" class="num"><%=el.giftMoney%></td>

                        <td><%=v.empName || '-'%></td>
                        <td><%=v.postName ||'-'%></td>
                        <td class="num"><%=v.saleAmount ||'-'%></td>
                        <td class="num"><%=v.saleCommission || '-'%></td>
                        <td rowspan="<%=len%>"><%=el.storeName%></td>

                        <td rowspan="<%=len%>" title="<%=el.orderCode%>"><%=el.orderCode%></td>
                    </tr> 
                    <%
                        empList.map(function(it,i){
                        %>
                            <tr>
                                <td><%=it.empName%></td>
                                <td><%=it.postName%></td>
                                <td class="num"><%=it.saleAmount%></td>
                                <td class="num"><%=it.saleCommission%></td>
                            </tr>
                        <%
                        }) 
                    %>  
                    <%});
                    %>
            </tbody>
        </table>
    </script>
    <!--end赠送统计-->

    <script type="text/template" id="keywords-tpl">
        <div class="dropdown">筛选:<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><em class="currentItem"><%=keyWords[0]%></em></button>
            <ul class="dropdown-menu">
                <%keyWords.map(function(el,index){%>
                    <li>
                        <a href="javascript:;" class="keyItems">
                            <%=el %>
                        </a>
                    </li>
                    <%});%>
            </ul>
        </div>
    </script>

    <!-- start 固定首列 -->
    <script type="text/template" id="fixed-coloum-tpl">
        <!--  用法  fixed-coloum-header first-coloum-flag
                1、先在 thead 的第一个th 添加class="fixed-coloum-header" 
                2、在tbody 的第一行的第一个td 添加类 first-coloum-flag
            -->
        <div class="first-coloum-wrap" style="height: 100%;background-color: #fff;position: absolute;z-index: 10;top: 0;left: 0;bottom: 0; overflow-y: auto;">
            <div class="layout-col2-v">
                <section class="t-header" text-center style="border-bottom: 1px solid #eee; width: 100%;color: #999;"></section>
                <div class="layout-clo2-content">
                    <div class="scroll-content">
                        <section class="t-body-tr">
                            <%
                                                    data.list.map(function(el,index){
                                                            %>
                                <section padding-left-right flexbox align-center style="height: <%=el.height%>;overflow: hidden;color:<%=el.color%>">

                                    <p style="vertical-align: middle;">
                                        <%=el.name%>
                                    </p>
                                </section>
                                <%
                                                    })
                                            %>
                        </section>
                    </div>
                </div>
            </div>
        </div>
    </script>
    <!-- end 固定首列 -->
    <script type="text/template" id="summary-tpl">
        <%list.map(function(el,index){%>
            <label>
             <%=el.name%>：<span class="sale" data-key="<%=el.key%>" data-value="<%=el.value%>"><%= isNaN(el.value ) ? el.value : miliFormat(((el.value-0).toFixed(2)-0)) %></span></label>
            <%});%>
                <span class="note"><i>!</i><%=note%></span>
    </script>
    <script src="dist/lib/jquery/jquery.min.js?v=2000"></script>
    <script src="dist/js/concat.js?v=2000"></script>
    <script src="dist/lib/underscore/underscore-min.js?v=2.0.0"></script>
    <script src="dist/lib/backbone/backbone-min.js?v=2.0.0"></script>
    <!-- <script src="dist/js/report/report.config.js?v=2.0.0"></script>
    <script src="dist/js/report/report-staff.js?v=3.0.0"></script> -->
    <script src="dist/js/report/report.min.js?v=3.0.0"></script>

    <!-- start excel导出需要的库-->
    <div id="hook"></div>
    <script>
        function create_script_element(src, existingnode) {
            var script = document.createElement('script');
            script.src = 'http://indevtest.oss-cn-shenzhen.aliyuncs.com/' + src;
            $hook.appendChild(script);

        }
        var $hook = document.getElementById('hook');
        var scripts = [
            'shim.js',
            'xlsx.full.min.js',
            'Blob.js', 'FileSaver.js', 'swfobject.js', 'downloadify.min.js', 'base64.min.js'
        ]
        if (!/android|iphone|ipad/.test(navigator.userAgent.toLowerCase())) {
            scripts.map(function(el) {
                create_script_element(el, $hook);
            })
        }
    </script>
    <!--<script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/shim.js"></script>-->
    <!--<script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/xlsx.full.min.js"></script>-->
    <!--<script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/Blob.js"></script>
    <script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/FileSaver.js"></script>
    <script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/swfobject.js"></script>
    <script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/downloadify.min.js"></script>
    <script src="http://indevtest.oss-cn-shenzhen.aliyuncs.com/base64.min.js"></script>-->
    <!-- end  -->
    <script src="dist/js/report/exportexcel.js?v=1.0.0"></script>
</body>

</html>