"use strict";!function(e){function t(e){var t=e?new Date(e):new Date,r=t.getFullYear(),a=t.getMonth()>9?t.getMonth()+1:"0"+(t.getMonth()+1),o=(t.getDate(),new Date(r+"-"+a+"-01")),i=864e5,d=new Date(o-i),n=d.getFullYear(),s=d.getMonth()>9?d.getMonth()+1:"0"+(d.getMonth()+1),l=d.getDate();return{startTime:n+"-"+s+"-01",endTime:n+"-"+s+"-"+l}}function r(e){var r=new Date;r.setDate(r.getDate()-6);var a,o=[],i=1;switch(e){case"week":for(var d=0;d<7;d++)a=r.getFullYear()+"-"+(r.getMonth()+1>9?r.getMonth()+1:"0"+(r.getMonth()+1))+"-"+(r.getDate()>9?r.getDate():"0"+r.getDate()),o.push(a),r.setDate(r.getDate()+i);break;case"month":r=new Date;var n=r.getFullYear()+"-"+(r.getMonth()+1>9?r.getMonth()+1:"0"+(r.getMonth()+1)),s=n+"-01",l=r.getFullYear()+"-"+(r.getMonth()+1>9?r.getMonth()+1:"0"+(r.getMonth()+1))+"-"+(r.getDate()>9?r.getDate():"0"+r.getDate());o.push(s),o.push(l);break;case"year":r=new Date;var s=r.getFullYear()+"-01-01",l=r.getDate(0);o.push(s),o.push(l);break;case"day":r=new Date;var p=r.getFullYear()+"-"+(r.getMonth()+1>9?r.getMonth()+1:"0"+(r.getMonth()+1))+"-"+(r.getDate()>9?r.getDate():"0"+r.getDate());o.push(p),o.push(p);break;case"all":o.push("1999-01-01"),o.push(getDate(0));break;case"lastMonth":o.length=0;var m=t();o.push(m.startTime),o.push(m.endTime)}return{startTime:o[0],endTime:o[o.length-1]}}function a(e){var t=e&&"today"!==e&&"day"!==e?e:"day",a=r(t);d.start?$(".startTime").val(d.start):$(".startTime").val(a.startTime),d.end?$(".endTime").val(d.end):$(".endTime").val(a.endTime)}var o=new Path,i=o.getUri("charts"),d=o.paraMap(e.location.href),n=r("week"),s=r("day"),l=(r("month"),r("lastMonth")),p="表格太长可以拖动",m=new Date,u=m.getMonth()+1,c=u<10?"0"+u:u,h=m.getFullYear()+"-"+c,v={base:{device:d.device?d.device:"",sessionId:d.sessionId?d.sessionId:"",account:d.account?d.account:"admin",version:d.version?d.version:"1.0.0"},queryString:d,tpl:d.tpl,reportEmp:{url:i+"api/doReport/reportEmp",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,keyWord:"",start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,bcOnly:"1",orderName:"consumeCom",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额","手工工资总额","提成合计"],value:["salesAch","consumeAch","manualCom","sumCom"]},searchConfig:{showKeyWord:!0,keyWord:["员工姓名"],time:"week",showCheckbox:{text:"只显示美容师与顾问",param:"bcOnly",checked:!0,checkedVal:"1",checkVal:""}},note:{text:p}},reportEmpSaleDetail:{url:i+"api/doReport/reportEmpSalesDetail",body:{data:{empId:void 0===d.empId?"":d.empId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,storeId:d.storeId,keyWord:"",type:""}},summary:{key:["销售业绩总额","销售提成总额"],value:["sales","commission"]},searchConfig:{showKeyWord:!0,keyWord:["项目","类型"],time:"week"},note:{text:"搜索支持【关键字+类型】如: 美白 家居"}},reportArrearDetail:{url:i+"api/doReport/reportArrearDetail",body:{data:{empId:void 0===d.empId?"":d.empId,storeId:void 0===d.storeId?"":d.storeId,keyWord:""}},summary:{key:["应收总额","实收总额","欠款总额"],value:["allMoney","recivedMoney","restMoney"]},searchConfig:{showTime:!1,showKeyWord:!0,keyWord:["客户","顾问"],showTip:{text:"<i class='red-block'></i>红色代表销户用户"}},note:{text:p}},reportEmpComDetail:{url:i+"api/doSta/staEmpConDetail",body:{data:{empId:void 0===d.empId?"":d.empId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,storeId:d.storeId,dateType:4}},summary:{key:["消耗业绩总额","消耗提成总额","手工工资","消耗数量"],value:["consume","commission","extrawage","consumeNumber"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},reportCustomer:{url:i+"api/doReport/reportCustomer",body:{data:{storeId:d.storeId,empId:d.empId,id:d.id,keyWord:"",start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,orderName:"sales",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consume"]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["会员姓名","会员编号"]},note:{text:p}},reportTotalDebt:{url:i+"api/doReport/reportTotalDebt",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,keyWord:"",orderName:"sumAmount",orderType:"desc"}},summary:{key:["赠送合计总额","合计总额","欠款总额"],value:["giftAmount","sumAmount","debtMoney"]},searchConfig:{showKeyWord:!0,showTime:!1,time:"week",keyWord:["会员名称","会员编号"]},note:{text:p}},reportProduct:{url:i+"api/doReport/reportProduct",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,keyWord:"",orderName:"sales",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!0,time:"today"},note:{text:p}},reportProductDetail:{url:i+"api/doReport/reportCustomerProduct",body:{data:{id:void 0===d.id?"":d.id,storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end}},summary:{key:["购买金额","购买数量","消耗数量"],value:["sales","sellNumber","consumeNumber"]},searchConfig:{showKeyWord:!1,showTime:!1,searchBtn:!1},note:{text:p}},reportCard:{url:i+"api/doReport/reportCard",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,keyWord:"",orderName:"totalNumber",orderType:"desc"}},summary:{key:["总数量","未消耗总额"],value:["totalNumber","restCardAmount"]},searchConfig:{showTime:!1,time:"week",showKeyWord:!0,keyWord:["项目名称"]},note:{text:p}},reportCardDetail:{url:i+"api/doReport/reportCardDetail",body:{data:{keyWord:"",storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,name:void 0===d.name?"":decodeURI(d.name)}},summary:{key:["数量"],value:["length"]},searchConfig:{showTime:!1,time:"week",showKeyWord:!0,keyWord:["会员名"]},note:{text:p}},reportAreaRefund:{url:i+"api/doAreaReport/reportAreaRefund",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end}},summary:{key:[],value:[]},searchConfig:{showTime:!0,time:"week",showKeyWord:!1,keyWord:["会员名"]},note:{text:p}},reportRefund:{url:i+"api/doReport/reportRefund",body:{data:{keyWord:"",storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end}},summary:{key:["退款金额（现金）汇总","退款金额（会员卡）汇总","退款金额（金额卡）汇总"],value:["cashPaySum","balancePaySum","productPaySum"]},searchConfig:{showTime:!0,time:"week",showKeyWord:!0,keyWord:["会员名","产品名"]},note:{text:p}},reportWorkDetail:{url:i+"api/doReport/reportWorkDetail",body:{data:{brandId:void 0===d.organizationId?"":d.organizationId,storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,customerId:void 0===d.customerId?"":d.customerId,cempId:d.cempId,keyWord:"",eValue:d.eValue,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,page:1,size:20}},summary:void 0===d.organizationId?{key:["消耗业绩总额","消耗业绩","消耗提成","手工工资","赠送消耗"],value:["storeConsume","workEmpList-consumeAch","workEmpList-commission","workEmpList-extrawage"],serverValue:["sumConsume","sumCA","sumCC","sumEx","sumGiftConsume"]}:{key:[],value:[],serverValue:[]},searchConfig:{showKeyWord:!0,time:"today",keyWord:["会员名称","会员编号","员工名称","项目名称"]},note:{text:p}},reportMarketDetail:{url:i+"api/doReport/reportMarketDetail",body:{data:{brandId:void 0===d.organizationId?"":d.organizationId,storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,customerId:void 0===d.customerId?"":d.customerId,keyWord:"",start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,needConsume:"",page:1,size:20}},summary:void 0===d.organizationId?{key:["销售业绩总额","实收总额","现金","银联","销售提成总额"],value:["sales","realRec","cashPay","unionPay","marketEmpList-empSaleCommission"],serverValue:["sumSales","sumRec","sumCash","sumUnion","scSum"]}:{key:[],value:[],serverValue:[]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["会员名称","会员编号","员工名称","项目名称"]},note:{text:"拖动表格"}},reportMarketDetailConsume:{url:i+"api/doReport/reportMarketDetail",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,customerId:void 0===d.customerId?"":d.customerId,keyWord:"",start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,needConsume:"1",page:1,size:20}},summary:{key:["门店消耗业绩总额","实收总额","现金","银联","消耗提成总额"],value:["consume","realRec","cashPay","unionPay","marketEmpList-empConsumeComission"],serverValue:["sumConsume","sumRec","sumCash","sumUnion","ccSum"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},reportStore:{url:i+"api/doReport/reportStore",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end}},summary:{key:["销售总额","消耗总额","新客总数","到访人头","销售目标","消耗目标"],value:["totalStroeSales","totalStoreConsume","newNumber","arriveSum","saleTarget","consumeTarget"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:".."}},reportCategory:{url:i+"api/doReport/reportCategory",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,keyWord:"",orderName:"sales",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!1,time:"today"},note:{text:p}},reportNextCategory:{url:i+"api/doReport/reportNextCategory",body:{data:{storeId:d.storeId,id:d.id,start:n.startTime,end:n.endTime,keyWord:""}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!0,time:"week"},note:{text:p}},reportCustomerCard:{url:i+"api/doReport/reportCustomerCard",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,keyWord:"",orderName:"totalNumber",orderType:"desc"}},summary:{key:["购买总数量","剩余次数总量"],value:["totalNumber","totalRestTimes"]},searchConfig:{time:"week",showTime:!1,showKeyWord:!0,keyWord:["会员名称","会员编号"]},note:{text:p+" 点击查看详情"}},reportCustomerCardDetail:{url:i+"api/doReport/reportCustomerCardDetail",body:{data:{customerId:void 0===d.customerId?"":d.customerId,keyWord:""}},summary:{key:["购买总数量","剩余总次数"],value:["totalNumber","totalRestTimes"]},searchConfig:{showKeyWord:!0,time:"week",showTime:!1,keyWord:["项目名称"]},note:{text:p}},reportBrand:{url:i+"api/doReport/reportBrandStores",body:{data:{brandId:void 0===d.organizationId?"":d.organizationId,keyWord:"",start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end}},summary:{key:["销售合计总额","消耗合计总额","新客总数"],value:["totalStroeSales","totalStoreConsume","newNumber"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},reportBrandProduct:{url:i+"api/doReport/reportBrandProduct",body:{data:{brandId:void 0===d.organizationId?"":d.organizationId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,keyWord:"",orderName:"sales",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!1,time:"today"},note:{text:p}},reportCustomerArrive:{url:i+"api/doReport/reportCustomerArrive",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,empId:d.empId,keyWord:""}},summary:{key:["到店总次数","客户数"],value:["arriveCount","length"]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["名称","编号"]},note:{text:p}},reportBrandCoupons:{url:i+"api/doReport/couponBrandPage",body:{data:{orgId:void 0===d.organizationId?d.storeId:d.organizationId,keyWord:"",id:void 0===d.couponId?"":d.couponId}},summary:{key:[],value:[]},searchConfig:{showKeyWord:!0,time:"today",keyWord:["券名","门店"]},note:{text:p}},reportStoreCoupons:{url:i+"api/doReport/couponBrandPage",body:{data:{orgId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,keyWord:"",id:void 0===d.couponId?"":d.couponId}},summary:{key:[],value:[]},searchConfig:{showKeyWord:!0,time:"today",keyWord:["券名"]},note:{text:p}},reportStoreCouponsDetail:{url:i+"api/doReport/couponStorePage",body:{data:{orgId:void 0===d.storeId?"":d.storeId,keyWord:"",id:void 0===d.couponId?"":d.couponId}},summary:{key:[],value:[]},searchConfig:{showTime:!1,showKeyWord:!0,time:"today",keyWord:["券号","会员"]},note:{text:p}},reportStoreCouponsConsumeDetail:{url:i+"api/doReport/reportCouponConsumeDetail",body:{data:{orgId:void 0===d.storeId?d.organizationId:d.storeId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showKeyWord:!0,time:"today",keyWord:["券名","券号","会员"]},note:{text:p}},reportBrandCard:{url:i+"api/doReport/reportBrandCard",body:{data:{brandId:void 0===d.organizationId?"":d.organizationId,empId:void 0===d.empId?"":d.empId,keyWord:"",orderName:"totalNumber",orderType:"desc"}},summary:{key:["总数量","未消耗总额"],value:["totalNumber","restCardAmount"]},searchConfig:{showTime:!1,time:"week",showKeyWord:!0,keyWord:["项目名称"]},note:{text:p}},reportBrandCategory:{url:i+"api/doReport/reportBrandCategory",body:{data:{brandId:void 0===d.brandId?"":d.brandId,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,keyWord:"",orderName:"sales",orderType:"desc"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!1,time:"today"},note:{text:p}},reportRcommission:{url:i+"api/doReport/reportRcommission",body:{data:{storeId:void 0===d.storeId?"":d.storeId,empId:void 0===d.empId?"":d.empId,start:l.startTime,end:l.endTime,type:d.type,keyWord:""}},summary:{key:[1==d.type?"销售提成总额":"消耗提成总额"],value:["amount"]},searchConfig:{showTime:!0,time:"lastMonth",showKeyWord:!0,keyWord:["员工"]},note:{text:"支持月份查询，"+p}},areaReportEvalute:{url:i+"api/doAreaReport/reportEvalute",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,empId:void 0===d.empId?"":d.empId,eValue:""===d.eValue?"":d.eValue,start:void 0===d.start?s.startTime:d.start,end:void 0===d.end?s.endTime:d.end,isFirst:""===d.eValue?"1":"0"}},summary:{key:["星级总数"],value:["eCount"]},searchConfig:{showTime:!0,time:"today",showKeyWord:!1,keyWord:["项目名称"]},note:{text:p}},areaReportBusiness:{url:i+"api/doAreaReport/reportBusiness",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,isFirst:""===d.isFirst?"1":"0"}},summary:{key:["销售合计总额","消耗合计总额","新客总数","到访人头"],value:["totalStroeSales","totalStoreConsume","newNumber","arriveSum"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},areaReportCategory:{url:i+"api/doAreaReport/reportCategory",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,id:d.id?d.id:"",start:n.startTime,end:n.endTime,isFirst:""===d.isFirst?"1":"0"}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},areaReportCard:{url:i+"api/doAreaReport/reportCard",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,isFirst:""===d.isFirst||"1"==d.isFirst?"1":"0",name:decodeURIComponent(void 0===d.name?"":d.name),keyWord:""}},summary:{key:["总数量","未消耗总额"],value:["totalNumber","restCardAmount"]},searchConfig:{showTime:!1,time:"week",showKeyWord:!0,keyWord:["项目名称"]},note:{text:p}},areaReportProduct:{url:i+"api/doAreaReport/reportProduct",body:{data:{orgId:void 0===d.organizationId?"":d.organizationId,isFirst:""===d.isFirst||"1"==d.isFirst?"1":"0",id:d.id?d.id:"",start:n.startTime,end:n.endTime,keyWord:""}},summary:{key:["销售业绩总额","消耗业绩总额"],value:["sales","consumes"]},searchConfig:{showKeyWord:!0,time:"today",keyWord:["产品名称"]},note:{text:p}},reportCustomerSource:{url:i+"api/doReport/reportCustomerSource",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:n.startTime,end:n.endTime}},summary:{key:["销售总额","消耗总额"],value:["sales","consume"]},searchConfig:{showKeyWord:!1,time:"week"},note:{text:p}},reportTakeGoods:{url:i+"api/doReport/billReport",body:{data:{organizationId:void 0===d.organizationId?"":d.organizationId,start:n.startTime,end:n.endTime,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["产品名称"]},note:{text:p}},reportTakeGoodsDetail:{url:i+"api/doReport/billReportDetail",body:{data:{organizationId:void 0===d.organizationId?d.branchId:d.organizationId,productId:void 0===d.productId?"":d.productId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,keyWord:""}},summary:{key:["销售数量","已取货数量","剩余数量"],value:["quantity","pickQuantity","suplusQuantity"]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["会员名称"]},note:{text:p}},customerTransOrdersReport:{url:i+"api/doReport/customerTransOrdersReport",body:{data:{storeId:void 0===d.storeId?"":d.storeId,start:void 0===d.start?n.startTime:d.start,end:void 0===d.end?n.endTime:d.end,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showKeyWord:!0,time:"week",keyWord:["客户姓名","客户编号"]},note:{text:p}},totalInventoryReport:{url:i+"api/doWareHouse/monthInvertoryByOrganization",body:{data:{organizationList:[{organizationId:void 0===d.organizationId?"":d.organizationId}],keyWord:"",month:void 0===d.start?h:d.start}},summary:{key:[],value:[]},searchConfig:{showTime:!1,showMonth:!0,showKeyWord:!0,keyWord:["产品名称","产品编号"],time:"thisMonth"},note:{text:p}},inventoryDetailReport:{url:i+"api/doWareHouse/monthInvertoryDetailByOrganization",body:{data:{organizationId:void 0===d.organizationId?"":d.organizationId,productId:void 0===d.productId?"":d.productId,month:void 0===d.start||"undefined"===d.start?h:d.start,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showTime:!1,showMonth:!0,showKeyWord:!1,time:"thisMonth"},note:{text:p}},storageInventoryReport:{url:i+"api/doWareHouse/monthInvertoryByStorage",body:{data:{organizationList:[{organizationId:void 0===d.organizationId?"":d.organizationId}],keyWord:"",month:void 0===d.start?h:d.start}},summary:{key:[],value:[]},searchConfig:{showTime:!1,showMonth:!0,showKeyWord:!0,keyWord:["产品名称","产品编号"],time:"thisMonth"},note:{text:p}},storageInventoryDetailReport:{url:i+"api/doWareHouse/monthInvertoryDetailByStorage",body:{data:{storageId:void 0===d.storageId?"":d.storageId,organizationId:void 0===d.organizationId?"":d.organizationId,productId:void 0===d.productId?"":d.productId,month:void 0===d.start||"undefined"===d.start?h:d.start,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showTime:!1,showMonth:!0,showKeyWord:!1,time:"thisMonth"},note:{text:p}},goodsTradeReport:{url:i+"api/doWareHouse/monthInvertoryDetailByStorage",body:{data:{storageId:void 0===d.storageId?"":d.storageId,organizationId:void 0===d.organizationId?"":d.organizationId,productId:void 0===d.productId?"":d.productId,month:void 0===d.start||"undefined"===d.start?h:d.start,keyWord:""}},summary:{key:[],value:[]},searchConfig:{showTime:!0,showKeyWord:!0,showSelect:!0,time:"week",keyWord:["产品名称"]},note:{text:p}}};a(v[v.tpl].searchConfig.time),e.reportApi=v}(window),function(e){var t={itemsOnPage:20,currentIndex:1};e.miliFormat=function(){var t=/(^|\s)\d+(?=\.?\d*($|\s))/g,r=/(?=(?!\b)(\d{3})+\.?\b)/g;return function(a){return isNaN(+a)||e.excle?a:a&&a.toString().replace(t,function(e){return e.replace(r,",")})}}(),e.decomposition=function(e,t){var r=[],a=0,o=0;e>=t?(a=e,o=t):(a=t,o=e);for(var i=parseInt(a/o),d=a%o,n=0;n<o;n++)r.push(i);for(var n=0;n<d;n++)r[n]++;var s=0,l=[];l.push({index:s,value:r[s]});for(var p=1;p<r.length;p++)s+=r[p-1],l.push({index:s,value:r[p]});return{list:r,map:l}},e.JsCallNativeBridge=function(t,r){var a=e.navigator.userAgent.toLowerCase();try{if(a.indexOf("android")>0&&NativeBridge&&NativeBridge[t](r),a.indexOf("iphone")>0||a.indexOf("ipad")>0){var o={fnname:t,data:r};e.webkit.messageHandlers.webViewApp.postMessage(o)}}catch(i){console.warn(i),console.warn(r)}},e.device=function(){var t=e.navigator.userAgent.toLowerCase(),r={isMobile:!1};return t.indexOf("ipad")>0||t.indexOf("iphone")>0||t.indexOf("android")>0?r.isMobile=!0:r.isMobile=!1,r};var r,a=Backbone.View.extend({className:"table-wrapper",events:{"tap thead .sortable":"sortField"},checkIsPages:function(e){return!(!e||!e.data||Object.keys(e.data).join("").indexOf("totalSize")==-1)},initialize:function(e){this.currentIndex=e.currentIndex-1},render:function(){var e=[];return this.checkIsPages(this.model)?e=this.model.data.data:this.model.data instanceof Array&&(e=this.model.data.slice(this.currentIndex*t.itemsOnPage,t.itemsOnPage*(this.currentIndex+1))),this.$el.html(this.template({data:e,excle:!1})),this},sortField:function(e){var t,r=$(e.currentTarget),a=(r.index(),r.data("sort"));if(r.hasClass("asc")){r.removeClass("asc"),r.addClass("desc");var t="order/desc/"+a}else{r.removeClass("desc"),r.addClass("asc");var t="order/asc/"+a}te.navigate(t,{trigger:!0,replace:!1})}}),o=a.extend({template:_.template($("#reportMarketDetail-tpl").html())}),i=a.extend({template:_.template($("#reportMarketDetailConsume-tpl").html())}),d=a.extend({template:_.template($("#reportWorkDetail-tpl").html())}),n=a.extend({template:_.template($("#reportCard-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("name"),a="&tpl=reportCardDetail&name="+r,o=e.location.href.substring(0,e.location.href.indexOf("&tpl"))+a;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:r,url:o}]):e.location.href=o}}}),s=a.extend({template:_.template($("#reportCardDetail-tpl").html())}),l=a.extend({template:_.template($("#reportAreaRefund-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(".startTime").val(),a=$(".endTime").val(),o=$(t.currentTarget).data("storename"),i=$(t.currentTarget).data("storeid"),d="&storeId="+i+"&tpl=reportRefund&start="+r+"&end="+a,n=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+d;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:o,url:n}]):e.location.href=n}}}),p=a.extend({template:_.template($("#reportRefund-tpl").html())}),m=a.extend({template:_.template($("#reportProduct-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(".startTime").val(),a=$(".endTime").val(),o=$(t.currentTarget).data("name"),i=$(t.currentTarget).data("id"),d=reportApi.queryString.storeId,n="&storeId="+d+"&tpl=reportProductDetail&id="+i+"&start="+r+"&end="+a,s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+n;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:o,url:s}]):e.location.href=s}}}),u=a.extend({template:_.template($("#reportProductDetail-tpl").html())}),c=a.extend({template:_.template($("#reportTotalDebt-tpl").html())}),h=a.extend({template:_.template($("#reportArrearDetail-tpl").html())}),v=a.extend({template:_.template($("#reportEmp-tpl").html()),events:{"tap thead .sortable":"sortField","tap tbody tr":"showEmpDetailBtn"},showEmpDetailBtn:function(t){var r=$(".startTime").val(),a=$(".endTime").val(),o=$(t.currentTarget).data().id;$(t.currentTarget).data().name;if(o){var i="storeId="+reportApi.queryString.storeId+"&empId="+o+"&start="+r+"&end="+a+"&tpl=",d=e.location.href.substring(0,e.location.href.indexOf("?"))+"?";e.JsCallNativeBridge("openReportDetailView",[{title:"销售详情",url:d+(i+"reportEmpSaleDetail")},{title:"消耗详情",url:d+(i+"reportEmpComDetail")}]),"a"===t.target.nodeName.toLowerCase()&&("sale"===$(t.target).data().role?e.location.href=d+(i+"reportEmpSaleDetail"):e.location.href=d+(i+"reportEmpComDetail"))}}}),g=a.extend({template:_.template($("#reportEmpSaleDetail-tpl").html())}),y=a.extend({template:_.template($("#reportEmpComDetail-tpl").html())}),f=a.extend({template:_.template($("#reportCustomer-tpl").html())}),I=a.extend({template:_.template($("#reportStore-tpl").html())}),w=a.extend({template:_.template($("#reportCategory-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d=reportApi.queryString.storeId,n="storeId="+d+"&tpl=reportNextCategory&id="+r+"&start="+a+"&end"+o,s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+n;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,url:s}]):e.location.href=s}}}),T=w.extend({template:_.template($("#reportCategory-tpl").html())}),C=a.extend({template:_.template($("#reportCustomerCard-tpl").html()),events:{"tap thead .sortable":"sortField","tap tbody tr":"showDetail"},initialize:function(e){this.currentIndex=e.currentIndex-1},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d="customerId="+r+"&tpl=reportCustomerCardDetail&start="+a+"&end="+o;e.JsCallNativeBridge("openReportDetailView",[{title:i+"-卡项负债详情",url:e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+d}]),device().isMobile||(e.location.href=e.location.pathname+"?"+d)}}}),b=a.extend({template:_.template($("#reportCustomerCardDetail-tpl").html())}),k=a.extend({template:_.template($("#reportBrand-tpl").html())}),x=a.extend({template:_.template($("#reportBrandCategory-tpl").html())}),D=a.extend({template:_.template($("#reportBrandProduct-tpl").html())}),R=a.extend({template:_.template($("#reportBrandCard-tpl").html())}),W=a.extend({template:_.template($("#areaReportEvalute-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("value");if(!r)return;var o=$(".startTime").val(),i=$(".endTime").val(),d=$(t.currentTarget).data("name"),n=$(t.currentTarget).data("lv"),s="organizationId="+r+"&tpl=areaReportEvalute&eValue="+a+"&start="+o+"&end="+i;0==n&&(s="cempId="+r+"&tpl=reportWorkDetail&eValue="+a+"&start="+o+"&end="+i);var l=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+s;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:0==n?d+"门店消耗":d+"-区域管理",url:l}]):e.location.href=l}}}),A=a.extend({template:_.template($("#areaReportBusiness-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d=$(t.currentTarget).data("lv"),n="organizationId="+r+"&tpl=areaReportBusiness&isFirst=0&start="+a+"&end="+o;0==d&&(n="storeId="+r+"&tpl=reportStore&start="+a+"&end="+o);var s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+n;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,url:s}]):e.location.href=s}}}),S=a.extend({template:_.template($("#reportRcommission-tpl").html())}),N=a.extend({template:_.template($("#reportCustomerArrive-tpl").html())}),M=a.extend({template:_.template($("#reportBrandCoupons-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("couponid");if(!r)return;var o=$(".startTime").val(),i=$(".endTime").val(),d=$(t.currentTarget).data("name"),n="storeId="+r+"&tpl=reportStoreCouponsDetail&couponId="+a+"&start="+o+"&end="+i,s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+n;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:d,url:s}]):e.location.href=s}}}),B=a.extend({template:_.template($("#reportStoreCoupons-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d="&tpl=reportStoreCouponsDetail&couponId="+r+"&start="+a+"&end="+o,n=e.location.href.substring(0,e.location.href.indexOf("&tpl"))+d;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,url:n}]):e.location.href=n}}}),z=a.extend({template:_.template($("#reportStoreCouponsDetail-tpl").html())}),P=a.extend({template:_.template($("#reportStoreCouponsConsumeDetail-tpl").html())}),O=a.extend({template:_.template($("#areaReportCategory-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("orgid");if(!r)return;var o=$(".startTime").val(),i=$(".endTime").val(),d=$(t.currentTarget).data("name"),n=$(t.currentTarget).data("lv"),s="organizationId="+a+"&tpl=areaReportCategory&isFirst=0&id="+r+"&start="+o+"&end="+i;0==n&&(s="storeId="+r+"&tpl=reportCategory&start="+o+"&end="+i);var l=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+s;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:d,url:l}]):e.location.href=l}}}),K=a.extend({template:_.template($("#areaReportCard-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d=$(t.currentTarget).data("lv"),n="organizationId="+r+"&tpl=areaReportCard&isFirst=0&name="+decodeURIComponent(i)+"&start="+a+"&end="+o;0==d&&(n="storeId="+r+"&tpl=reportCardDetail&name="+i+"&start="+a+"&end="+o);var s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+n;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,url:s}]):e.location.href=s}}}),F=a.extend({template:_.template($("#areaReportProduct-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("orgid");if(!r)return;var o=$(".startTime").val(),i=$(".endTime").val(),d=$(t.currentTarget).data("name"),n=$(t.currentTarget).data("orgname"),s=$(t.currentTarget).data("lv");if("0"!=s)var l="organizationId="+a+"&tpl=areaReportProduct&isFirst=0&id="+r+"&start="+o+"&end="+i;else var l="&storeId="+a+"&tpl=reportProductDetail&id="+r+"&start="+o+"&end="+i;var p=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+l;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:d,orgName:n,url:p}]):e.location.href=p}}}),V=a.extend({template:_.template($("#reportCustomerSource-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name"),d="storeId="+reportApi.queryString.storeId+"&tpl=reportCustomer&id="+r+"&start="+a+"&end"+o,n=e.location.href.substring(0,e.location.href.indexOf("?"))+"?"+d;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,url:n}]):e.location.href=n}}}),E=a.extend({template:_.template($("#reportTakeGoods-tpl").html()),events:{"tap tbody tr":"showDetail","tap thead .sortable":"sortField"},showDetail:function(t){if("tr"==t.currentTarget.tagName.toLowerCase()){var r=$(t.currentTarget).data("id");if(!r)return;var a=$(".startTime").val(),o=$(".endTime").val(),i=$(t.currentTarget).data("name")+"（"+$(t.currentTarget).data("store")+"）",d="?organizationId="+$(t.currentTarget).data("organizationid")+"&tpl=reportTakeGoodsDetail&productId="+r+"&start="+a+"&end="+o,n=e.location.href.substring(0,e.location.href.indexOf("?"))+d;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:i,
url:n}]):e.location.href=n}}}),L=a.extend({template:_.template($("#reportTakeGoodsDetail-tpl").html())}),J=a.extend({template:_.template($("#customerTransOrdersReport-tpl").html()),events:{"tap tbody tr":"showDetailBtn","tap thead .sortable":"sortField"},showDetailBtn:function(t){var r,a,o=$(t.currentTarget).data("id"),i=$(t.currentTarget).data("storeid"),d=$(t.currentTarget).data("time");if(r=a=d.substring(0,d.indexOf(" ")),o){var n="storeId="+i+"&customerId="+o+"&start="+r+"&end="+a+"&tpl=",s=e.location.href.substring(0,e.location.href.indexOf("?"))+"?";e.JsCallNativeBridge("openReportDetailView",[{title:"销售详情",url:s+(n+"reportMarketDetail")},{title:"消耗详情",url:s+(n+"reportWorkDetail")}]),"a"===t.target.nodeName.toLowerCase()&&("sale"===$(t.target).data().role?e.location.href=s+(n+"reportMarketDetail"):e.location.href=s+(n+"reportWorkDetail"))}}}),j=a.extend({template:_.template($("#totalInventoryReport-tpl").html()),events:{"tap tbody tr":"showDetailBtn","tap thead .sortable":"sortField"},showDetailBtn:function(t){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("name"),o=$(".startTime").val(),i="&productId="+r+"&start="+o+"&tpl=inventoryDetailReport",d=e.location.href.substring(0,e.location.href.indexOf("&tpl"))+i;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:a+"交易明细",url:d}]):e.location.href=d}}),H=a.extend({template:_.template($("#inventoryDetailReport-tpl").html())}),Y=a.extend({template:_.template($("#storageInventoryReport-tpl").html()),events:{"tap tbody tr":"showDetailBtn","tap thead .sortable":"sortField"},showDetailBtn:function(t){var r=$(t.currentTarget).data("id"),a=$(t.currentTarget).data("storageid"),o=$(t.currentTarget).data("name"),i=$(".startTime").val(),d="&productId="+r+"&storageId="+a+"&start="+i+"&tpl=storageInventoryDetailReport",n=e.location.href.substring(0,e.location.href.indexOf("&tpl"))+d;device().isMobile?e.JsCallNativeBridge("openReportDetailView",[{title:o+"交易明细",url:n}]):e.location.href=n}}),q=a.extend({template:_.template($("#storageInventoryDetailReport-tpl").html())}),G=a.extend({template:_.template($("#goodsTradeReport-tpl").html())}),U=[{name:"reportEmp",view:v},{name:"reportEmpSaleDetail",view:g},{name:"reportEmpComDetail",view:y},{name:"reportCustomer",view:f},{name:"reportTotalDebt",view:c},{name:"reportProduct",view:m},{name:"reportProductDetail",view:u},{name:"reportCard",view:n},{name:"reportCardDetail",view:s},{name:"reportWorkDetail",view:d},{name:"reportMarketDetail",view:o},{name:"reportMarketDetailConsume",view:i},{name:"reportStore",view:I},{name:"reportCategory",view:w},{name:"reportNextCategory",view:T},{name:"reportCustomerCard",view:C},{name:"reportCustomerCardDetail",view:b},{name:"reportAreaRefund",view:l},{name:"reportRefund",view:p},{name:"reportBrand",view:k},{name:"reportBrandCategory",view:x},{name:"reportBrandProduct",view:D},{name:"reportBrandCard",view:R},{name:"reportArrearDetail",view:h},{name:"areaReportEvalute",view:W},{name:"reportRcommission",view:S},{name:"areaReportBusiness",view:A},{name:"areaReportCategory",view:O},{name:"areaReportCard",view:K},{name:"areaReportProduct",view:F},{name:"reportCustomerArrive",view:N},{name:"reportCustomerSource",view:V},{name:"reportTakeGoods",view:E},{name:"reportTakeGoodsDetail",view:L},{name:"reportBrandCoupons",view:M},{name:"reportStoreCoupons",view:B},{name:"reportStoreCouponsDetail",view:z},{name:"reportStoreCouponsConsumeDetail",view:P},{name:"customerTransOrdersReport",view:J},{name:"totalInventoryReport",view:j},{name:"inventoryDetailReport",view:H},{name:"storageInventoryReport",view:Y},{name:"storageInventoryDetailReport",view:q},{name:"goodsTradeReport",view:G}],Q=[],X=[],Z=Backbone.View.extend({el:"body",initialize:function(e){this.currentPage=1,this.hasRender=!1,this.initData(e.data),this.render(this.currentPage,e.data),$(".searchForm").on("submit",this.search)},events:{"tap .sortItem .keyItems":"selectSortItem","tap .searchByTime":"search","tap .searchCheckbox":"searchCheckbox","tap .selected":"showType","tap .option":"selectType"},selectSortItem:function(e){$(".currentItem").text($(e.target).html())},searchCheckbox:function(){var e=!$(".searchCheckbox input").is(":checked"),t=reportApi[reportApi.tpl].body.data,r=reportApi[reportApi.tpl].searchConfig.showCheckbox,a=r.param;e?t[a]=r.checkedVal:t[a]=r.checkVal},showType:function(e){$(".select").toggleClass("none"),$(".selected").toggleClass("more")},selectType:function(e){var t=$(e.target).text();if($(e.target).toggleClass("on"),$(e.target).hasClass("on"))Q.push(t),X.push($(e.target).attr("value"));else{var r=Q.indexOf(t);r>-1&&(Q.splice(r,1),X.splice(r,1))}$(".selected").text(Q.join(",")),$(".selected").attr("value",X.join(",")),$(".selected").text()||($(".selected").text("全部"),$(".selected").attr("value","0")),console.log($(".selected").text()),console.log($(".selected").attr("value"))},render:function(e,t){this.summary(t.data);var r=this.tableView(reportApi.tpl,e,t);$(".table-body").html(r.render().el),0===t.data.length&&this.noDataView(),t.data.data&&0===t.data.data.length&&this.noDataView(),$("#fixTable").tableHeadFixer(),this.fixedTableColoum()},fixedTableColoum:function(){var e=[];if($(".first-coloum-flag").map(function(t,r){e.push({name:($(r).text()+"").trim(),height:$(r)[0].clientHeight+"px",color:$(r).parent().css("color")})}),0!=e.length)try{var t=_.template($("#fixed-coloum-tpl").html(),{variable:"data"}),r=t({list:e,excle:!0});$(r).insertBefore("#fixTable"),$(".first-coloum-wrap").css("width",$(".fixed-coloum-header")[0].clientWidth+"px"),$(".t-header").text($(".table .fixed-coloum-header").text());var a=$(".table .fixed-coloum-header")[0].offsetHeight;$(".t-header").css({height:a+"px","line-height":a+"px"}),$(document).ready(function(){$($(".table-wrapper div")[0]).scroll(function(e){var t=$($(".table-wrapper div")[0]).scrollTop();0===t?($(".layout-col2-v .t-header").css("border-bottom","1px solid #eee"),$(".t-body-tr").css("transform","translate3d(0,0px,0)")):($(".t-body-tr").css("transform","translate3d(0,"+-t+"px,0)"),$(".layout-col2-v .t-header").css("border-bottom","1px solid transparent")),$(".t-body-tr")[0].offsetHeight})})}catch(o){console.error(o)}},checkIsPages:function(e){return!(!e||!e.data)&&!(!e.hasOwnProperty("totalSize")||!e.hasOwnProperty("pageNum"))},summary:function(t){function r(e){if(!e||0===e.length)return"请输入关键字";var t={};return e.map(function(e,r){var a=e.substring(0,4);t[a]=a}),Object.keys(t).join("/")}if(t){var a=reportApi[reportApi.tpl].summary,o=a.key,i=this.checkIsPages(t)?a.serverValue:a.value,d={};if(i.map(function(e,t){d[e]=0}),t.length>0&&t.map(function(e,r){i.map(function(r,a){var o=r.split("-");if(o.length>1){var i=o[0],n=o[1];e[i].map(function(e,t){isNaN(e[n]-0)?d[r]+=0:d[r]+=e[n]?e[n]-0:0})}else"reportCustomerCardDetail"==reportApi.queryString.tpl&&e[r]-0>=9999&&"totalRestTimes"===r?d[r]+=0:"length"==r?d[r]=t.length:d[r]+=e[r]?e[r]-0:0})}),this.checkIsPages(t)){var n=t.sumMap;i.map(function(e,t){d[e]=n[e]-0})}var s=[],l=e.cacheReportData;i.map(function(e,t){if("reportStore"!==reportApi.tpl&&"areaReportBusiness"!==reportApi.tpl||!l.reportStore)if("reportRefund"===reportApi.tpl&&l.reportRefund){var r=0;r="cashPaySum"===e||"balancePaySum"===e||"productPaySum"===e?l.reportRefund[e]:d[e],s.push({name:o[t],value:isNaN(r)?r:r-0})}else s.push({name:o[t],value:d[e]});else{var r=0;r="saleTarget"===e||"consumeTarget"===e||"arriveSum"===e?l.reportStore[e]:d[e],s.push({name:o[t],value:isNaN(r)?r:r-0})}});var p=_.template($("#summary-tpl").html()),m=p({list:s,note:reportApi[reportApi.tpl].note.text});$(".description").html(m);var u=reportApi[reportApi.tpl].searchConfig;if(u.showKeyWord){var c=r(u.keyWord);$("input[type=search]").attr("placeholder",c)}}},limitTime:function(e,t){var r=7776e6;if(e&&t){var a=e.split("-"),o=new Date;o.setFullYear(a[0]),o.setMonth(a[1]-1),o.setDate(a[2]);var i=new Date,d=t.split("-");return i.setFullYear(d[0]),i.setMonth(d[1]-1),i.setDate(d[2]),i-o>r}return!1},search:function(e){e.preventDefault();var t=$(".searchKey").val(),r=$(".currentItem").text(),a=$(".startTime").val(),o=$(".endTime").val(),i=$(".selected").attr("value"),d=!$(".searchCheckbox input").is(":checked"),n=reportApi[reportApi.tpl].body.data;"goodsTradeReport"==reportApi.tpl&&(n.select=i,$(".select").addClass("none"),$(".selected").removeClass("more")),console.log("时间"+a);var s="search/"+(t.trim()?t.trim():void 0)+"/"+r+"/"+a+"/"+o+"/"+i+"/"+d;return te.navigate(s,{trigger:!0,replace:!1}),!1},initData:function(e){try{if(!this.hasRender){var r=e.data,a=r.length;e&&Object.keys(r).join("").indexOf("totalSize")!=-1&&(a=r.totalSize-0),$("#pagination-bar").pagination({items:a,itemsOnPage:t.itemsOnPage,cssStyle:"light-theme",prevText:"«",nextText:"»",hrefTextPrefix:"#page/"});var o=a/t.itemsOnPage,i=isNaN(Number.parseInt(o))?0:Number.parseInt(o);$(".pageInfo").text("每页 "+t.itemsOnPage+" 条，总共 "+(o>i?i+1:i)+" 页　"),this.hasRender=!0}}catch(d){console.warn(d)}},tableView:function(e,t,r){for(var a,o={model:r,currentIndex:t?t:1},i=U.length-1;i>=0;i--){var d=U[i];if(e==d.name){a=d.view;break}}var n=new a(o);return n},noDataView:function(){var e=_.template($("#nodata-tpl").html());$(".tbody").html(e({len:$("thead th").length,width:$(".table-wrapper").width()/2})),"reportStore"!=reportApi.tpl&&$(".description .sale").text("0")}}),ee=Backbone.Router.extend({initialize:function(){this.data={};var t=reportApi.tpl.indexOf("#");t>0&&(reportApi.tpl=reportApi.tpl.substring(0,reportApi.tpl.indexOf("#")));var a=this.assembling(reportApi,reportApi[reportApi.tpl]),o=reportApi[reportApi.tpl].url,i=this;this.setConfig(reportApi),location.hash.indexOf("#search")==-1&&this.loadData(o,a,function(){},function(t){i.data=t,r=e.$app=new Z({data:t})})},routes:{"page/:index":"pageTuring","":"loadData","order/desc/:field":"descOrder","order/asc/:field":"ascOrder","search/:searchKey/:searchField/:selected/:searchCheckbox/:start/:end":"search"},setConfig:function(e){var t=reportApi[reportApi.tpl].searchConfig,r=t.showKeyWord,a=t.showTime,o=t.showCheckbox,i=t.showTip,d=t.showMonth,n=(t.searchBtn,r?"":"hidden"),s=a||void 0===a?"":"hidden";if($(".time-label").addClass(n),"hidden"===s&&$(".table-nav .time-text").remove(),d&&$(".table-nav .month-text").removeClass("none"),$(".table-nav .time-text").addClass(s),t.keyWord&&t.keyWord.length>0){var l=_.template($("#keywords-tpl").html()),p=l({keyWords:t.keyWord});$(".sortItem").html(p)}if(o&&o.text.length>0&&($(".searchCheckbox").removeClass("none"),$(".searchCheckbox span").text(o.text),$(".searchCheckbox input").prop("checked",o.checked)),i&&i.text.length>0&&($(".showTip").removeClass("none"),$(".showTip").html(i.text)),"today"==t.time){var m=reportApi[reportApi.tpl].body.data;$(".startTime").val(m.start),$(".endTime").val(m.end)}if("thisMonth"==t.time){var m=reportApi[reportApi.tpl].body.data;$(".startTime").val(m.month)}t.showSelect&&$(".select-box").removeClass("none"),t.searchBtn===!1&&$(".searchByTime").hide()},pageTuring:function(e){var t,a;0!=$(".desc").length?(t=$(".desc").index(),a="desc"):0!=$(".asc").length&&(t=$(".asc").index(),a="asc");var o=this.assembling(reportApi,reportApi[reportApi.tpl]),i=reportApi[reportApi.tpl].url;if(o.data.hasOwnProperty("page")&&o.data.hasOwnProperty("size")){o.data.page=e;var d=this;this.loadData(i,o,function(){},function(t){t&&t.data&&(d.data=t,r.render(e,d.data))})}else r.render(e,this.data);$($("thead th")[t]).addClass(a)},assembling:function(e,t){var r=t.body;for(var a in e.base)r[a]=e.base[a];return r},loadData:function(t,r,a,o){function i(t){if(t.data=t.data||{},t.data.data||t.data.dataList)if("reportRefund"===reportApi.tpl){var r=t.data.cashPaySum,a=t.data.balancePaySum,o=t.data.productPaySum;e.cacheReportData.reportRefund={cashPaySum:r,balancePaySum:a,productPaySum:o},t.data=t.data.dataList}else{var i=t.data.consumeTarget,d=t.data.saleTarget,n=t.data.arriveSum;e.cacheReportData.reportStore={consumeTarget:i,saleTarget:d,arriveSum:n},e.localStorage.setItem("businessHeader",JSON.stringify(t.data.paymentModelList)),t.data=t.data.data}else t.data=[];return t}var d=this.assembling(reportApi,reportApi[reportApi.tpl]);e.cacheReportData.reportStore=void 0,e.cacheReportData.reportRefund=void 0,$.ajax({timeout:3e4,data:JSON.stringify(d),url:t,beforeSend:a,success:function(t){var r=t;"areaReportBusiness"===reportApi.tpl||"reportStore"===reportApi.tpl||"reportRefund"===reportApi.tpl?r=i(t):"reportMarketDetail"!==reportApi.tpl&&"reportMarketDetailConsume"!==reportApi.tpl||e.localStorage.setItem("businessHeader",JSON.stringify(t.data.paymentModelList)),o(r)},contentType:"application/json",dataType:"json",type:"POST",error:function(e,t,r){"timeout"==t&&console.error("timeout timeout timeout ...")},complete:function(){}})},descOrder:function(e){this.data.data.sort(function(t,r){return r[e]-t[e]}),r.render(1,this.data),$("#pagination-bar").pagination("drawPage",1),$('.sortable[data-sort="'+e+'"]').addClass("desc")},ascOrder:function(e){this.data.data.sort(function(t,r){return t[e]-r[e]}),r.render(1,this.data),$("#pagination-bar").pagination("drawPage",1),$('.sortable[data-sort="'+e+'"]').addClass("asc")},handleProjectType:function(e){try{var t=e.trim(),r=t.split(" "),a=[];r.map(function(e,t){e&&a.push(e)}),r=a;var o="",i="",d={"套盒":"productBox","次数卡":"frequencyCard","金额卡":"amountCard","合作项目":"cooperativeProject","套餐":"projectPackage","服务项目":"serviceProject","仪器":"instrument","家居产品":"cosmetics","会员充值":"memberCard"};if(1===r.length){var n=r[0].trim();d[n]?(o="",i=d[n]):(o=r[0],i="")}else{o=r.slice(0,r.length-1).join("");var s=r[r.length-1]?r[r.length-1].trim():"";d[s]?i=d[s]:(o=t,i="")}}catch(l){console.error("搜索处理=>"+l)}return{keyWord:o,type:i}},search:function(t,a,o,i){$(".searchKey").blur();var d=this.assembling(reportApi,reportApi[reportApi.tpl]);if(d.data.keyWord="undefined"===t?"":t,"reportEmpSaleDetail"===reportApi.tpl)if(d.data.keyWord){var n=this.handleProjectType(t);d.data.keyWord=n.keyWord,d.data.type=n.type}else d.data.keyWord="",d.data.type="";var s=reportApi[reportApi.tpl],l=s.searchConfig.showTime,p=s.searchConfig.showMonth,m=s.searchConfig.showKeyWord;l||void 0===l?(d.data.start=o,d.data.end=i,$(".startTime").val(o),$(".endTime").val(i)):(delete d.data.start,delete d.data.end),p?(d.data.month=o,$(".startTime").val(o)):delete d.data.month,m||delete d.data.keyWord,d.data.page&&(d.data.page=1);var u=reportApi[reportApi.tpl].url,c=this;this.loadData(u,d,function(){$(".first-coloum-wrap").length>0&&$(".first-coloum-wrap").remove();var e=_.template($("#loading-tpl").html());$(".tbody").html(e({len:$("thead th").length,width:$(".table-wrapper").width()/2}))},function(t){"000000"==t.retCode&&t.data?(c.data=t,e.$app||(r=e.$app=new Z({data:t})),r.hasRender=!1,r.initData(c.data),r.render(1,c.data)):(e.$app||(r=e.$app=new Z({data:t})),r.noDataView())})}});e.cacheReportData={};var te=new ee;Backbone.history.start()}(window);